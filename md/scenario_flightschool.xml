<?xml version="1.0" encoding="utf-8"?>
<mdscript name="Scenario_FlightSchool" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
  <cues>
    <cue name="X4ep1_Gamestart_FlightSchool" module="x4ep1_gamestart_flightschool">
      <conditions>
        <event_cue_signalled cue="md.Setup.GameStart" />
      </conditions>
      <actions>
        <set_value name="$DebugChance" exact="0"/>
        <set_value name="$UseCaseDebugChance" exact="0"/>
        <set_value name="md.$TutorialActive" exact="true" comment="silence global hints"/>
        <set_value name="md.$SurpressTutorials" exact="true" comment="surpress tutorials"/>

        <create_list name="$QueuedUseCases"/>

        <debug_text text="'Setup for X4ep1_Gamestart_FlightSchool'" chance="$DebugChance"/>

        <set_value name="$AlliedFaction" exact="faction.argon"/>
        <set_value name="$FlightInstructorMacro" exact="macro.character_flight_school_instructor_macro"/>
        <set_value name="$AlliedCrew" exact="'argon_military_crew'"/>

        <set_faction_relation faction="$AlliedFaction" otherfaction="faction.player" value="$AlliedFaction.relation.ally.min" />
        <set_faction_relation_locked faction="faction.player" locked="true" />
        <set_faction_relation_locked faction="$AlliedFaction" locked="true" />

        <!--HACK? This shouldn't be necessary, the wares are already in the gamestart-->
        <add_inventory entity="player.entity" ware="ware.weapon_gen_spacesuit_laser_01_mk1" exact="1" />
        <add_inventory entity="player.entity" ware="ware.weapon_gen_spacesuit_repairlaser_01_mk1" exact="1" />
        <add_inventory entity="player.entity" ware="ware.software_scannerobjectmk3" exact="1" />
        <add_inventory entity="player.entity" ware="ware.engine_gen_spacesuit_01_mk2" exact="1" />

        <set_value name="$Station" exact="player.station"/>

        <set_value name="$PlayerShipMacro" exact="macro.ship_arg_s_fighter_04_a_macro"/>
        <create_group groupname="$PlayerShipGroup"/>

        <set_dynamic_interior_persistent object="$Station" room="player.room" persistent="true"/>
        <set_dynamic_interior_private object="$Station" room="player.room" private="true"/>
        <find_object_component name="$StartCorridor" object="player.room.dynamicinterior" macro="macro.room_arg_corridor_01_macro"/>
        <set_triggers_locked room="$StartCorridor" group="tag.door_01" locked="true"/>

        <set_value name="$MatchSpeedShipMacro" exact="macro.ship_gen_xs_cargodrone_empty_01_a_macro"/>

        <set_value name="$TargetPracticeFlimsyMacro" exact="macro.ship_gen_xs_cargodrone_empty_01_a_macro"/>
        <set_value name="$TargetPracticeShieldedMacro" exact="macro.ship_arg_s_miner_solid_01_a_macro"/>

        <create_object name="$SpaceSuitTutorialWreck" macro="macro.env_debris_station_l_05_container_macro" comment="alternative macro: env_debris_debris_l_02_container_macro" owner="faction.ownerless" sector="player.sector">
          <!--TODO correct wreck position-->
          <position x="0m" z="0m"/>
        </create_object>
        <find_object_component name="$SpaceSuitTutorialInterior" object="$SpaceSuitTutorialWreck" macro="macro.int_exploration_02_macro"/>
        <create_position name="$SpaceSuitTutorialInteriorEntryPos" object="$SpaceSuitTutorialInterior" z="-10m" space="$SpaceSuitTutorialWreck"/>
        <!--create a sequence of guidance positions to lead the player into the space suit exploration wreck-->
        <create_list name="$SpaceSuit_EnterWreck_GuidancePositions"/>
        <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-392" z="-267"/>
        <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
        <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-371" z="-269"/>
        <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
        <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-356" z="-278"/>
        <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
        <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-338" z="-278"/>
        <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
        <remove_value name="$SpaceSuit_EnterWreck_GuidancePosition"/>
        <find_object_component name="$SpaceSuitTutorialEntryRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_1"/>
        <find_object_component name="$SpaceSuitTutorialLockboxRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_2"/>
        <find_object_component name="$SpaceSuitTutorialDummyRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_3"/>
        <destroy_object object="$SpaceSuitTutorialDummyRepairPanel"/>
        <remove_value name="$SpaceSuitTutorialDummyRepairPanel"/>
        <find_object_component groupname="$InteriorCollectables" object="$SpaceSuitTutorialInterior" macro="macro.sm_gen_wares_exploration_01_macro" includeobjects="true" multiple="true"/>
        <destroy_group group="$InteriorCollectables"/>
        <create_position name="$LockboxPosition" object="$SpaceSuitTutorialInterior" x="-30" z="45.7" space="$SpaceSuitTutorialWreck.zone"/>
        <create_object name="$SpaceSuitTutorialLockbox" macro="macro.sm_gen_lockbox_unusual_01_macro" owner="faction.ownerless" zone="$SpaceSuitTutorialWreck.zone" spinning="false">
          <position value="$LockboxPosition"/>
        </create_object>
        <set_object_min_hull object="$SpaceSuitTutorialLockbox" exact="1"/>
        <set_object_radar_visible object="$SpaceSuitTutorialLockbox" visible="false"/>
        <set_drop_object object="$SpaceSuitTutorialLockbox" drop="'drops_flightschool_lockbox'"/>
        <add_to_group groupname="$SpaceSuitTutorialLocks" list="$SpaceSuitTutorialLockbox.locks.operational.list"/>
        <disable_collisions_between object="$SpaceSuitTutorialWreck" target="$SpaceSuitTutorialLockbox"/>
        <disable_collision_response object="$SpaceSuitTutorialLockbox"/>

        <create_cue_actor name="$FlightInstructor" cue="this" macro="$FlightInstructorMacro">
          <owner exact="$AlliedFaction"/>
          <page exact="10190"/>
          <skills>
            <skill type="piloting"    exact="15"/>
            <skill type="management"  exact="3"/>
            <skill type="morale"      exact="15"/>
            <skill type="engineering" exact="9"/>
            <skill type="boarding"    exact="3"/>
          </skills>
        </create_cue_actor>
        <set_entity_traits entity="$FlightInstructor" missionactor="true" customhandler="true"/>
        <set_entity_role entity="$FlightInstructor" role="entityrole.passenger"/>
        <set_entity_overrides entity="$FlightInstructor" title="'{20208,30101}'" icon="'captain'"/>
        <add_actor_to_room actor="$FlightInstructor" object="player.room">
          <position x="2.13" y="0" z="-1.92"/>
          <rotation yaw="-150deg"/>
        </add_actor_to_room>
        <set_actor_lookat actor="$FlightInstructor" component="player.entity"/>
        <debug_text text="'Created flight instructor ' + $FlightInstructor.knownname + ' with voice page ' + $FlightInstructor.page" chance="$DebugChance"/>
      </actions>
      <cues>
        <cue name="FlightSchool_Init">
          <delay exact="2s"/>
          <actions>
            <create_mission cue="X4ep1_Gamestart_FlightSchool" type="missiontype.tutorial" name="{1021,5000}" description="{1021,5001}" difficulty="level.easy" faction="$AlliedFaction">
              <briefing>
                <objective step="1" action="objective.custom" customaction="{30178,1059}"/>
              </briefing>
            </create_mission>
            <!--Create a list of tutorial cues to trigger in that order-->
            <set_value name="$SignalList" exact="[FlightSchool_HelpBox,
                                                  FlightSchool_InputProfile,
                                                  FlightSchool_MessageTicker,
                                                  FlightSchool_Introduction,
                                                  FlightSchool_FPLook,
                                                  FlightSchool_FPWalk,
                                                  FlightSchool_FPJump,
                                                  FlightSchool_FPCrouch,
                                                  FlightSchool_Dialog,
                                                  FlightSchool_EmbarkAndUndock,
                                                  FlightSchool_ShipSteering_UseCase,
                                                  FlightSchool_ShipSteering_Stick,
                                                  FlightSchool_ShipSteering_MouseMode,
                                                  FlightSchool_ShipSteering_MouseTemp,
                                                  FlightSchool_ShipSteering_Keyboard,
                                                  FlightSchool_ShipSteering_MouseDirect,
                                                  FlightSchool_ShipRoll_Precheck,
                                                  FlightSchool_ShipRoll_AutoRoll,
                                                  FlightSchool_ShipRoll_Stick,
                                                  FlightSchool_ShipRoll_Keyboard,
                                                  FlightSchool_ShipStrafing,
                                                  FlightSchool_ShipForward_UseCase,
                                                  FlightSchool_ShipForward_Controller,
                                                  FlightSchool_ShipForward_MouseWheel,
                                                  FlightSchool_ShipReverse_UseCase,
                                                  FlightSchool_ShipReverse_Controller,
                                                  FlightSchool_ShipReverse_MouseWheel,
                                                  FlightSchool_ShipSpeed_FullStop,
                                                  FlightSchool_Camera_UseCase,
                                                  FlightSchool_CockpitCamera,
                                                  FlightSchool_ExternalCamera,
                                                  FlightSchool_FloatingCamera,
                                                  FlightSchool_ToggleCockpit,
                                                  FlightSchool_TestCourse,
                                                  FlightSchool_TravelMode,
                                                  FlightSchool_AutoPilot_Start,
                                                  FlightSchool_Logbook,
                                                  FlightSchool_AutoPilot_Finish,
                                                  FlightSchool_Targeting,
                                                  FlightSchool_ShipSpeed_MatchTarget,
                                                  FlightSchool_ShootingPrimary,
                                                  FlightSchool_ShootingSecondary,
                                                  FlightSchool_ManageWeapons,
                                                  FlightSchool_CycleWeaponGroups,
                                                  FlightSchool_CycleMissile,
                                                  FlightSchool_RelativeMovement,
                                                  FlightSchool_SpaceSuit,
                                                  FlightSchool_FlightAssist,
                                                  FlightSchool_Docking,
                                                  FlightSchool_AdaptiveSteering,
                                                  FlightSchool_Complete,
                                                 ]"/>
            <set_value name="$Index" exact="0"/>
            <signal_cue cue="FlightSchool_TriggerNext"/>
          </actions>
        </cue>

        <cue name="FlightSchool_TriggerNext" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$Index" operation="add"/>
            <do_if value="$Index gt $SignalList.count">
              <debug_text text="'Flight school has been completed'" chance="$DebugChance"/>
            </do_if>
            <do_else>
              <debug_text text="'Triggering next tutorial stage: ' + $SignalList.{$Index}" chance="$DebugChance"/>
              <signal_cue cue="$SignalList.{$Index}"/>
            </do_else>
          </actions>
        </cue>

        <!-- Shortcut cues -->

        <cue name="FlightSchool_Shortcut_BasicFlight">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_BasicFlight_Warp">
              <actions>
                <debug_text text="'Creating ship at undocked position'" chance="$DebugChance"/>
                <!-- spawn just above a compatible dock -->
                <find_dockingbay name="$SpawnDock" object="$Station" walkable="true">
                  <match_dock size="$PlayerShipMacro.docksize"/>
                </find_dockingbay>
                <set_value name="$SpawnSpace" exact="$Station.zone"/>
                <create_position name="$SpawnPosition" object="$SpawnDock" y="50m" z="-10m" space="$SpawnSpace"/>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnDock.dockslot.relativerotation.{$SpawnSpace} ]"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_BasicFlight_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_BasicFlight_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_ShipSteering_UseCase} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shortcut_Travel">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_Travel_Warp">
              <actions>
                <debug_text text="'Creating ship at position outside the starting station'" chance="$DebugChance"/>
                <!-- spawn just outside of the starting station -->
                <set_value name="$SpawnSpace" exact="$Station.sector"/>
                <get_safe_pos result="$SpawnPosition" object="$Station" z="$Station.size" space="$SpawnSpace" sector="$SpawnSpace" radius="$PlayerShipMacro.boundingbox.max.z"/>
                <create_orientation name="$SpawnRotation" orientation="look_away" refobject="$Station">
                  <position value="$SpawnPosition"/>
                </create_orientation>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnRotation ]"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_Travel_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_Travel_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_TravelMode} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shortcut_Shooting">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_Shooting_Warp">
              <actions>
                <debug_text text="'Creating ship at position outside the starting station'" chance="$DebugChance"/>
                <!-- spawn just outside of the starting station -->
                <set_value name="$SpawnSpace" exact="$Station.sector"/>
                <get_safe_pos result="$SpawnPosition" object="$Station" z="$Station.size" space="$SpawnSpace" sector="$SpawnSpace" radius="$PlayerShipMacro.boundingbox.max.z"/>
                <create_orientation name="$SpawnRotation" orientation="look_away" refobject="$Station">
                  <position value="$SpawnPosition"/>
                </create_orientation>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnRotation ]"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_Shooting_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_Shooting_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_ShootingPrimary} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shortcut_SpaceSuit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_SpaceSuit_Warp">
              <actions>
                <!-- spawn in the vicinity of the space suit tutorial wreck, facing it -->
                <set_value name="$SpawnSpace" exact="$SpaceSuitTutorialWreck.sector"/>
                <get_safe_pos result="$SpawnPosition" object="$SpaceSuitTutorialWreck" z="$SpaceSuitTutorialWreck.size + 500m" space="$SpawnSpace" sector="$SpawnSpace" radius="$PlayerShipMacro.boundingbox.max.z"/>
                <create_orientation name="$SpawnRotation" orientation="look_at" refobject="$SpaceSuitTutorialWreck">
                  <position value="$SpawnPosition"/>
                </create_orientation>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnRotation ]"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_SpaceSuit_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_SpaceSuit_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_SpaceSuit} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shortcut_Docking">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_Docking_Warp">
              <actions>
                <debug_text text="'Creating ship at position outside the starting station'" chance="$DebugChance"/>
                <!-- spawn just outside of the starting station -->
                <set_value name="$SpawnSpace" exact="$Station.sector"/>
                <get_safe_pos result="$SpawnPosition" object="$Station" z="$Station.size" space="$SpawnSpace" sector="$SpawnSpace" radius="$PlayerShipMacro.boundingbox.max.z"/>
                <create_orientation name="$SpawnRotation" orientation="look_away" refobject="$Station">
                  <position value="$SpawnPosition"/>
                </create_orientation>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnRotation ]"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_Docking_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_Docking_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_Docking} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shortcut_Test">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <cancel_cue cue="$SignalList.{$Index}"/>
            <remove_help all="true"/>
            <remove_help_overlay all="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Shortcut_Test_Warp">
              <actions>
                <!-- spawn just outside of the starting station -->
                <debug_text text="'Creating ship at position outside the starting station'" chance="$DebugChance"/>
                <set_value name="$SpawnSpace" exact="$Station.sector"/>
                <get_safe_pos result="$SpawnPosition" object="$Station" z="$Station.size" space="$SpawnSpace" sector="$SpawnSpace" radius="$PlayerShipMacro.boundingbox.max.z"/>
                <create_orientation name="$SpawnRotation" orientation="look_away" refobject="$Station">
                  <position value="$SpawnPosition"/>
                </create_orientation>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnRotation ]"/>
                <!-- spawn just above a compatible dock -->
                <!--<debug_text text="'Creating ship at undocked position'" chance="$DebugChance"/>
                <find_dockingbay name="$SpawnDock" object="$Station" walkable="true">
                  <match_dock size="$PlayerShipMacro.docksize"/>
                </find_dockingbay>
                <set_value name="$SpawnSpace" exact="$Station.zone"/>
                <create_position name="$SpawnPosition" object="$SpawnDock" y="50m" z="-10m" space="$SpawnSpace"/>
                <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $SpawnSpace, $position = $SpawnPosition, $rotation = $SpawnDock.dockslot.relativerotation.{$SpawnSpace} ]"/>-->
              </actions>
              <cues>
                <cue name="FlightSchool_Shortcut_Test_TeleportPlayer">
                  <delay exact="1ms"/>
                  <actions>
                    <debug_text text="'Teleporting player to ship'" chance="$DebugChance"/>
                    <teleport_player object="$PlayerShip" instant="true" force="true" control="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Shortcut_Test_TriggerNext">
              <delay exact="1s"/>
              <actions>
                <set_value name="$Index" exact="$SignalList.indexof.{FlightSchool_AutoPilot_Start} - 1"/>
                <debug_text text="'Setting and triggering next cue: ' + $SignalList.{$Index + 1}" chance="$DebugChance"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <!-- conversation handlers -->

        <cue name="Shortcut_Conversation_Handler" instantiate="true">
          <conditions>
            <event_conversation_started conversation="default" actor="$FlightInstructor"/>
          </conditions>
          <actions>
            <do_if value="$CurrentUseCaseEndLines?">
              <remove_value name="$CurrentUseCaseEndLines"/>
            </do_if>
            <clear_list list="$QueuedUseCases"/>
            <add_npc_line line="1" comment="Yes?"/>
            <do_if value="$MedicalExamStarted?">
              <do_if value="$MedicalExamDone?">
                <add_player_choice position="top_left" text="{30178,1097}" section="continue_basic_flight" highlighted="true"/>
              </do_if>
              <do_else>
                <add_player_choice position="top_left" text="{30178,1098}" section="shortcut_basic_flight"/>
              </do_else>
              <add_player_choice position="left" text="{30178,1099}" section="shortcut_travel"/>
              <add_player_choice position="bottom_left" text="{30178,1100}" section="shortcut_shooting"/>
              <add_player_choice position="top_right" text="{30178,1101}" section="shortcut_spacesuit"/>
              <add_player_choice position="right" text="{30178,1102}" section="shortcut_docking"/>
              <add_player_choice position="bottom_right" text="{30178,1103}" section="shortcut_none"/>
              <do_if value="$ShowDialogHints?">
                <remove_help all="true"/>
                <do_if value="player.input.controller">
                  <show_help position="1" timeout="false" force="true" log="true" line="26200" comment="Hold $INPUT_STATE_DIALOG_MENU$ and use $INPUT_RANGE_MENUSCROLL_X$ and $INPUT_RANGE_MENUSCROLL_Y$ to select a dialogue option. Release $INPUT_STATE_DIALOG_MENU$ to confirm."/>
                </do_if>
                <do_elseif value="player.input.joystick">
                  <show_help position="1" timeout="false" force="true" log="true" line="26201" comment="Press $INPUT_ACTION_DIALOG_MENU_UP$, $INPUT_ACTION_DIALOG_MENU_DOWN$, $INPUT_ACTION_DIALOG_MENU_LEFT$ and $INPUT_ACTION_DIALOG_MENU_RIGHT$ to select a dialogue option. Press $INPUT_ACTION_DIALOG_MENU_SELECT$ to confirm."/>
                </do_elseif>
                <do_else>
                  <show_help position="1" timeout="false" force="true" log="true" line="26202" comment="Click on a dialogue option or press its number on the keyboard."/>
                </do_else>
              </do_if>
            </do_if>
          </actions>
        </cue>

        <cue name="Shortcut_Conversation_Handler_Finished" instantiate="true">
          <conditions>
            <event_conversation_next_section actor="$FlightInstructor" />
          </conditions>
          <actions>
            <do_if value="event.param == 'continue_basic_flight'">
              <signal_cue cue="FlightSchool_Dialog_Done"/>
            </do_if>
            <do_elseif value="event.param == 'shortcut_none' or event.param == 'g_cancel'">
              <add_npc_line line="3" comment="Right."/>
            </do_elseif>
            <do_else>
              <add_npc_line line="2" comment="I'll need to set everything up. Please give me a minute."/>
              <set_value name="$ShortcutSection" exact="event.param"/>
            </do_else>
            <do_if value="$ShowDialogHints?">
              <remove_help all="true"/>
            </do_if>
          </actions>
        </cue>

        <cue name="Shortcut_Conversation_Handler_SpeakFinished_ActivateShortcut" instantiate="true">
          <conditions>
            <event_conversation_finished actor="$FlightInstructor"/>
            <check_value value="$ShortcutSection?"/>
          </conditions>
          <actions>
            <fade_screen fadeout="0.5s" fadein="0.5s"/>
          </actions>
          <cues>
            <cue name="Shortcut_Conversation_Handler_FadeoutFinished">
              <delay exact="0.5s"/>
              <actions>
                <do_if value="$ShortcutSection == 'shortcut_basic_flight'">
                  <signal_cue cue="FlightSchool_Shortcut_BasicFlight"/>
                </do_if>
                <do_elseif value="$ShortcutSection == 'shortcut_travel'">
                  <signal_cue cue="FlightSchool_Shortcut_Travel"/>
                </do_elseif>
                <do_elseif value="$ShortcutSection == 'shortcut_shooting'">
                  <signal_cue cue="FlightSchool_Shortcut_Shooting"/>
                </do_elseif>
                <do_elseif value="$ShortcutSection == 'shortcut_spacesuit'">
                  <signal_cue cue="FlightSchool_Shortcut_SpaceSuit"/>
                </do_elseif>
                <do_elseif value="$ShortcutSection == 'shortcut_docking'">
                  <signal_cue cue="FlightSchool_Shortcut_Docking"/>
                </do_elseif>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Shortcut_Conversation_Handler_SpeakFinished_Resume" instantiate="true">
          <conditions>
            <event_speak_finished actor="$FlightInstructor" line="3"/>
          </conditions>
          <actions>
            <debug_text text="'Checking for callback cue'" chance="$DebugChance"/>
            <do_if value="$UseCaseInterruptedCallbackCue?">
              <debug_text text="'Signalling callback cue'" chance="$DebugChance"/>
              <signal_cue cue="$UseCaseInterruptedCallbackCue"/>
            </do_if>
          </actions>
        </cue>

        <!--This handler is supposed to disable conversations with all NPCs apart from the flight instructor and only works because there can be no other custom handlers in this module.-->
        <cue name="GreetingHandler" instantiate="true">
          <conditions>
            <event_conversation_started conversation="default"/>
            <check_value value="event.object != $FlightInstructor"/>
          </conditions>
          <actions>
            <add_npc_line line="2002" comment="Hello."/>
          </actions>
        </cue>

        <cue name="NPCCreated" instantiate="true">
          <conditions>
            <event_npc_created/>
          </conditions>
          <actions>
            <set_entity_traits entity="event.param" customhandler="true" />
          </actions>
        </cue>

        <!-- general cues that could trigger at various points -->

        <cue name="PlayerShipHullDamagedUseCase">
          <conditions>
            <event_object_hull_damaged group="$PlayerShipGroup"/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_PlayerShipHullDamaged', $endline = 12 ]" />
          </actions>
        </cue>

        <cue name="ShipMenuCallback" instantiate="true">
          <conditions>
            <event_ui_triggered screen="'DockedMenu'"/>
          </conditions>
          <actions>
            <do_if value="event.param2 == 'menu_close'">
              <remove_value name="$ShipMenuOpen"/>
            </do_if>
            <do_else>
              <set_value name="$ShipMenuOpen" exact="true"/>
            </do_else>
          </actions>
        </cue>

        <cue name="FlightSchool_CreatePlayerShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="event.param.$space.isclass.dockingbay">
              <create_ship name="$PlayerShip" macro="$PlayerShipMacro" dock="event.param.$space" capturable="false">
                <owner exact="faction.player" overridenpc="true" />
                <loadout ref="flightschool_player_ship" />
              </create_ship>
            </do_if>
            <do_elseif value="event.param.$space.isclass.zone">
              <create_ship name="$PlayerShip" macro="$PlayerShipMacro" zone="event.param.$space" capturable="false">
                <owner exact="faction.player" overridenpc="true" />
                <loadout ref="flightschool_player_ship" />
                <position value="event.param.$position"/>
                <rotation value="event.param.$rotation"/>
              </create_ship>
            </do_elseif>
            <do_else>
              <create_ship name="$PlayerShip" macro="$PlayerShipMacro" sector="event.param.$space" capturable="false">
                <owner exact="faction.player" overridenpc="true" />
                <loadout ref="flightschool_player_ship" />
                <position value="event.param.$position"/>
                <rotation value="event.param.$rotation"/>
              </create_ship>
            </do_else>
            <add_to_group groupname="$PlayerShipGroup" object="$PlayerShip"/>
            <set_object_min_hull object="$PlayerShip" exact="1"/>
            <add_cargo object="$PlayerShip" ware="ware.energycells" exact="10"/>
            <add_to_group groupname="$PlayerWeaponsGroup" list="$PlayerShip.weapons.operational.list"/>
            <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
              <remove_weapon_from_all_weapongroups weapon="$PlayerWeaponsGroup.{$i}"/>
            </do_all>
            <set_object_sellable object="$PlayerShip" sellable="false"/>
          </actions>
        </cue>

        <!-- Usecase helper cues with queueing support -->

        <cue name="TriggerInstructorUseCase" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <debug_text text="'Triggering usecase ' + event.param.$name" chance="$DebugChance"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[ $name = event.param.$name, $actors = table[ $FlightInstructor = $FlightInstructor ], $keeplookat = true, $debugchance = $UseCaseDebugChance ]" />
            <do_if value="event.param.$endline?">
              <set_value name="$CurrentUseCaseEndLines" exact="[event.param.$endline]"/>
            </do_if>
            <do_else>
              <set_value name="$CurrentUseCaseEndLines" exact="event.param.$endlines"/>
            </do_else>
            <debug_text text="'Valid end lines: ' + $CurrentUseCaseEndLines" chance="$DebugChance"/>
          </actions>
        </cue>

        <cue name="QueueInstructorUseCase" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$CurrentUseCaseEndLines?">
              <debug_text text="'Queueing usecase ' + event.param.$name" chance="$DebugChance"/>
              <append_to_list name="$QueuedUseCases" exact="event.param"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="TriggerInstructorUseCase" param="event.param" />
            </do_else>
          </actions>
        </cue>

        <cue name="InstructorUseCaseFinished" instantiate="true">
          <conditions>
            <event_speak_finished actor="$FlightInstructor"/>
            <debug_text text="'Instructor finished line ' + event.param2 + ', currently waiting for ' + if $CurrentUseCaseEndLines? then $CurrentUseCaseEndLines else 'nothing'" debugchance="$DebugChance"/>
            <check_value value="$CurrentUseCaseEndLines? and $CurrentUseCaseEndLines.indexof.{event.param2}"/>
          </conditions>
          <delay exact="0.5s"/>
          <actions>
            <debug_text text="'Queued usecases: ' + $QueuedUseCases.count" chance="$DebugChance"/>
            <do_if value="$QueuedUseCases.count">
              <debug_text text="'Next usecase: ' + $QueuedUseCases.{1}.$name" chance="$DebugChance"/>
              <signal_cue_instantly cue="TriggerInstructorUseCase" param="$QueuedUseCases.{1}" />
              <remove_from_list name="$QueuedUseCases" exact="$QueuedUseCases.{1}"/>
            </do_if>
            <do_else>
              <remove_value name="$CurrentUseCaseEndLines"/>
            </do_else>
          </actions>
        </cue>

        <!--<cue name="UITriggerDebug" instantiate="true">
          <conditions>
            <event_ui_triggered/>
          </conditions>
          <actions>
            <debug_text text="'UI triggered - param: ' + event.param + ' - param2: ' + event.param2 + ' - param3: ' + event.param3"/>
          </actions>
        </cue>-->

        <!-- Actual tutorial cues -->

        <cue name="FlightSchool_HelpBox">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <show_help position="4" timeout="false" force="true" allowclose="true" log="true" line="26001" comment="This is a help box. It stays on screen until you close it. Others may disappear after a certain time or after performing a required action.\n\nPress $INPUT_ACTION_ADDON_HELPTEXT_CLOSE$ now to close this one."/>
          </actions>
          <cues>
            <cue name="FlightSchool_HelpBox_Done">
              <conditions>
                <event_ui_triggered screen="'hintclosed'"/>
                <!--<event_ui_triggered screen="'hintclosed'" control="'THE_HINT_TEXT_ID'"/>-->
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_HelpBox"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_InputProfile">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1104}, {30178,1108}, [ 'yes', {30178,1119} ], [ 'no', {30178,1122} ] ]]"/>
          </actions>
          <cues>
            <cue name="FlightSchool_InputProfile_LoadProfileQuestionAnswered">
              <conditions>
                <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
              </conditions>
              <actions>
                <do_if value="event.param3 == 'yes'">
                  <open_menu menu="OptionsMenu" param="'profile_load'"/>
                </do_if>
                <do_else>
                  <signal_cue cue="FlightSchool_InputProfile_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="FlightSchool_InputProfile_ProfileMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_InputProfile_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_InputProfile_LoadProfileQuestionClosed">
              <conditions>
                <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_InputProfile_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_InputProfile_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_InputProfile"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_MessageTicker">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <show_help position="6" timeout="false" force="true" allowclose="true" log="true" line="26002" comment="The message ticker is in the bottom left corner of the screen. If you have an active mission, like now, your current objective will be shown there in orange text.\n\nPress $INPUT_ACTION_ADDON_HELPTEXT_CLOSE$ to continue."/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1060}"/>
          </actions>
          <cues>
            <cue name="FlightSchool_MessageTicker_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'hintclosed'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_MessageTicker"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Introduction">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Greeting', $endline = 1002 ]" />
            <debug_text text="'Setting callback cue'" chance="$DebugChance"/>
            <set_value name="$UseCaseInterruptedCallbackCue" exact="FlightSchool_Introduction_Done"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1061}"/>
            <set_value name="$MedicalExamStarted" exact="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Introduction_Done">
              <conditions>
                <check_any>
                  <event_speak_finished actor="$FlightInstructor" line="1002"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <debug_text text="'Removing callback cue'" chance="$DebugChance"/>
                <remove_value name="$UseCaseInterruptedCallbackCue"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Introduction"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FPLook">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FPLook', $endline = 1003 ]" />
            <do_if value="player.input.controller or player.input.joystick">
              <show_help position="1" timeout="false" force="true" log="true" line="26100" comment="Use $INPUT_RANGE_FP_YAW$ and $INPUT_RANGE_FP_PITCH$ to look around."/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26101" comment="Use the mouse to look around."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1062}"/>
          </actions>
          <cues>
            <cue name="FlightSchool_FPLook_UpOrDownCheck" checkinterval="0.1s">
              <conditions>
                <check_value value="player.entity.rotation.pitch gt 70deg or player.entity.rotation.pitch lt -70deg"/>
              </conditions>
              <delay exact="1s"/>
              <actions>
                <remove_help all="true"/>
                <do_if value="player.input.controller or player.input.joystick">
                  <do_if value="player.input.isinverted.firstperson.joystick.pitch">
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 14, 'invert_fp_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                  </do_if>
                  <do_else>
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 14, 'invert_fp_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                  </do_else>
                </do_if>
                <do_else>
                  <do_if value="player.input.isinverted.firstperson.mouse.pitch">
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 8, 'invert_fp_mouse_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                  </do_if>
                  <do_else>
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 8, 'invert_fp_mouse_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                  </do_else>
                </do_else>
              </actions>
              <cues>
                <cue name="FlightSchool_FPLook_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_FPLook_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FPLook_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FPLook"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FPWalk">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FPWalk', $endline = 1004 ]" />
            <set_value name="$FPWalkRoom" exact="player.room"/>
            <set_value name="$FPWalkStartPos" exact="player.entity.position"/>
            <do_if value="player.input.controller">
              <show_help position="1" timeout="false" force="true" log="true" line="26102" comment="Use $INPUT_RANGE_FP_WALK$ and $INPUT_RANGE_FP_STRAFE$ to walk."/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26103" comment="Hold $INPUT_STATE_FP_MOVE_FORWARD$, $INPUT_STATE_FP_MOVE_BACKWARD$, $INPUT_STATE_FP_STRAFE_LEFT$ and $INPUT_STATE_FP_STRAFE_RIGHT$ to walk."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1063}"/>
          </actions>
          <cues>
            <cue name="FlightSchool_FPWalk_DistanceCheck" checkinterval="0.1s">
              <conditions>
                <check_value value="$FPWalkRoom? and player.entity.distanceto.[$FPWalkRoom, $FPWalkStartPos] gt 3m"/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_FPWalk_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_FPWalk_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FPWalk"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FPJump">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FPJump', $endline = 1005 ]" />
            <show_help position="1" timeout="false" force="true" log="true" line="26106" comment="Press $INPUT_STATE_FP_JUMP$ to jump."/>
            <set_value name="$RequiredJumps" exact="3"/>
            <set_value name="$PerformedJumps" exact="0"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1064}">
              <progress text="{30178,1096}" progress="$PerformedJumps" max="$RequiredJumps" />
            </set_objective>
          </actions>
          <cues>
            <cue name="FlightSchool_FPJump_Check" checkinterval="0.1s">
              <conditions>
                <check_value value="$RequiredJumps? and player.input.firstperson.isjumping != $CurrentlyJumping?"/>
              </conditions>
              <actions>
                <do_if value="player.input.firstperson.isjumping">
                  <set_value name="$CurrentlyJumping" exact="true"/>
                </do_if>
                <do_else>
                  <remove_value name="$CurrentlyJumping"/>
                  <set_value name="$PerformedJumps" operation="add"/>
                  <update_objective_progress cue="X4ep1_Gamestart_FlightSchool" progress="$PerformedJumps" max="$RequiredJumps"/>
                </do_else>
                <do_if value="$PerformedJumps ge $RequiredJumps">
                  <remove_help all="true"/>
                  <signal_cue cue="FlightSchool_FPJump_Done"/>
                </do_if>
                <do_else>
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="FlightSchool_FPJump_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FPJump"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FPCrouch">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FPCrouch', $endline = 1006 ]" />
            <show_help position="1" timeout="false" force="true" log="true" line="26107" comment="Hold $INPUT_STATE_FP_CROUCH$ to crouch, release it to stand back up."/>
            <set_value name="$RequiredSquats" exact="3"/>
            <set_value name="$PerformedSquats" exact="0"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1065}">
              <progress text="{30178,1096}" progress="$PerformedSquats" max="$RequiredSquats" />
            </set_objective>
          </actions>
          <cues>
            <cue name="FlightSchool_FPCrouch_Check" checkinterval="0.1s">
              <conditions>
                <check_value value="$RequiredSquats? and player.input.firstperson.iscrouching != $CurrentlyCrouching?"/>
              </conditions>
              <actions>
                <do_if value="player.input.firstperson.iscrouching">
                  <set_value name="$CurrentlyCrouching" exact="true"/>
                </do_if>
                <do_else>
                  <remove_value name="$CurrentlyCrouching"/>
                  <set_value name="$PerformedSquats" operation="add"/>
                  <update_objective_progress cue="X4ep1_Gamestart_FlightSchool" progress="$PerformedSquats" max="$RequiredSquats"/>
                </do_else>
                <do_if value="$PerformedSquats ge $RequiredSquats">
                  <remove_help all="true"/>
                  <signal_cue cue="FlightSchool_FPCrouch_Done"/>
                </do_if>
                <do_else>
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="FlightSchool_FPCrouch_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FPCrouch"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Dialog">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$MedicalExamDone" exact="true"/>
            <set_value name="$ShowDialogHints" exact="true"/>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TalkToInstructor', $endline = 1010 ]" />
            <do_if value="player.input.controller or player.input.joystick">
              <show_help position="1" timeout="false" force="true" log="true" line="3108" comment="Press $INPUT_STATE_INTERACTION_MENU$ to interact."/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="3106" comment="You interact with $INPUT_STATE_INTERACTION_MENU$ or $INPUT_STATE_MOUSECLICK$."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.talkto" object="$FlightInstructor" />
          </actions>
          <cues>
            <cue name="FlightSchool_Dialog_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1s"/>
              <actions>
                <remove_value name="$ShowDialogHints"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Dialog"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_EmbarkAndUndock">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <!--create ship-->
            <find_dockingbay name="$StationDock" object="$Station" walkable="true">
              <match_dock size="$PlayerShipMacro.docksize"/>
            </find_dockingbay>
            <signal_cue_instantly cue="FlightSchool_CreatePlayerShip" param="table[ $space = $StationDock ]"/>
            <set_triggers_locked room="$StartCorridor" group="tag.door_01" locked="false"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.embark" object="$PlayerShip" />
            <signal_cue cue="FlightSchool_EmbarkAndUndock_Hints"/>
          </actions>
          <cues>
            <cue name="FlightSchool_EmbarkAndUndock_Hints" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_player_started_control/>
                  <event_player_stopped_control/>
                  <event_object_changed_room object="player.entity"/>
                </check_any>
              </conditions>
              <delay exact="1ms" />
              <actions>
                <do_if value="event.name != 'event_object_changed_room' or not event.param.dynamicinterior or event.param.dynamicinterior != event.param2.dynamicinterior">
                  <remove_help all="true"/>
                  <do_if value="player.ship and not player.occupiedship and player.ship.isplayerowned" comment="player standing in his ship">
                    <signal_cue cue="FlightSchool_EmbarkAndUndock_SitDownHint"/>
                  </do_if>
                  <do_elseif value="player.occupiedship and player.occupiedship.dock and player.ship.isplayerowned" comment="player sitting in his docked ship">
                    <signal_cue cue="FlightSchool_EmbarkAndUndock_UndockHint"/>
                  </do_elseif>
                  <do_elseif value="player.room == $PlayerShip.dock" comment="player standing in correct dockingbay">
                    <signal_cue cue="FlightSchool_EmbarkAndUndock_EmbarkHint" check="false"/>
                  </do_elseif>
                  <do_else comment="player in different room">
                    <signal_cue cue="FlightSchool_EmbarkAndUndock_TransporterHints"/>
                  </do_else>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_TransporterHints" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="not $FlightSchool_EmbarkAndUndock_TransporterHints_AlreadyTriggered?">
                  <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_GoToDock', $endline = 1008 ]" />
                  <set_value name="$FlightSchool_EmbarkAndUndock_TransporterHints_AlreadyTriggered" exact="true"/>
                </do_if>
                <find_npc_waypoint name="$TransporterSlot" object="player.room" tags="tag.npctransport"/>
                <do_if value="not @$TransporterSlot.count and player.room.dynamicinterior.exists">
                  <set_value name="$Rooms" exact="player.room.dynamicinterior.rooms"/>
                  <do_all exact="$Rooms.count" counter="$i">
                    <find_npc_waypoint name="$TransporterSlot" object="$Rooms.{$i}" tags="tag.npctransport"/>
                    <do_if value="$TransporterSlot">
                      <break/>
                    </do_if>
                  </do_all>
                </do_if>
                <do_if value="player.entity.distanceto.{$TransporterSlot} ge 3m">
                  <show_help position="1" timeout="false" force="true" line="26300" comment="Follow the line on the floor to your current objective."/>
                </do_if>
              </actions>
              <cues>
                <cue name="FlightSchool_TransporterRoom_Entered" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.entity.distanceto.{$TransporterSlot} lt 3m"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <do_if value="player.input.controller or player.input.joystick">
                      <show_help position="1" timeout="false" force="true" line="3108" comment="Press $INPUT_STATE_INTERACTION_MENU$ to interact."/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" line="3106" comment="You interact with $INPUT_STATE_INTERACTION_MENU$ or $INPUT_STATE_MOUSECLICK$."/>
                    </do_else>
                  </actions>
                </cue>

                <cue name="FlightSchool_TransporterRoom_MenuOpened" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'"/>
                  </conditions>
                  <actions>
                    <do_if value="event.param2 == ''">
                      <remove_help all="true"/>
                      <do_if value="player.room != $PlayerShip.dock">
                        <substitute_text text="$TransporterHintText" source="{1012,26301}" comment="Select your ship ($NAME$), then confirm with $INPUT_STATE_WIDGET_SELECT$.">
                          <replace string="'$NAME$'" with="$PlayerShip.name"/>
                        </substitute_text>
                        <show_help position="1" timeout="false" custom="$TransporterHintText"/>
                      </do_if>
                    </do_if>
                    <do_else>
                      <remove_help all="true"/>
                    </do_else>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_EmbarkHint" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="not $FlightSchool_EmbarkAndUndock_EmbarkHint_AlreadyTriggered?">
                  <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_EmbarkShip', $endline = 1009 ]" />
                  <remove_help all="true"/>
                  <do_if value="player.input.controller or player.input.joystick">
                    <show_help position="1" log="true" line="26104" comment="While walking, press $INPUT_ACTION_FP_RUN$ to start running."/>
                  </do_if>
                  <do_else>
                    <show_help position="1" log="true" line="26105" comment="Quickly press $INPUT_STATE_FP_MOVE_FORWARD$ twice to run."/>
                  </do_else>
                  <set_value name="$FlightSchool_EmbarkAndUndock_EmbarkHint_AlreadyTriggered" exact="true"/>
                </do_if>
                <show_help position="1" timeout="false" force="true" line="26302" comment="Keep following the line to enter your ship."/>
              </actions>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_SitDownHint" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <show_help position="1" timeout="false" force="true" log="true" line="1040" comment="To sit down in your chair"/>
                <cancel_cue cue="FlightSchool_EmbarkAndUndock_EmbarkHint"/>
              </actions>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_UndockHint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Undock_1', $endline = 2001 ]" />
                <show_help position="4" timeout="false" force="true" log="true" line="1031" comment="... press $INPUT_ACTION_DOCK_ACTION$ to undock."/>
                <show_help_overlay id="'docked_undock'" highlightonly="true"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.undock" />
                <cancel_cue cue="FlightSchool_EmbarkAndUndock_SitDownHint"/>
              </actions>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_UndockingStarted">
              <conditions>
                <event_object_undocking_started group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_undock'"/>
                <cancel_cue cue="FlightSchool_EmbarkAndUndock_UndockHint"/>
              </actions>
            </cue>

            <cue name="FlightSchool_EmbarkAndUndock_UndockingDone">
              <conditions>
                <event_object_undocked group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_EmbarkAndUndock"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSteering_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Steer', $endline = 2002 ]" />
            <signal_cue cue="FlightSchool_TriggerNext"/>
            <cancel_cue cue="FlightSchool_ShipSteering_UseCase"/>
          </actions>
        </cue>

        <cue name="FlightSchool_ShipSteering_Stick">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <show_help position="1" timeout="false" force="true" log="true" line="26400" comment="Use $INPUT_RANGE_STEERING_PRIMARY$ and $INPUT_RANGE_STEERING_PITCH$ to steer."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1068}"/>
            </do_if>
            <do_else>
              <signal_cue cue="FlightSchool_ShipSteering_Stick_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSteering_Stick_Strafing" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.vertical gt 0.5 or player.input.flight.vertical lt -0.5 or player.input.flight.horizontal gt 0.5 or player.input.flight.horizontal lt -0.5"/>
              </conditions>
              <delay exact="0.5s"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Strafe_TooEarly', $endline = 2008 ]" />
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_Stick_Pitching" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.pitch gt 0.5 or player.input.flight.pitch lt -0.5"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <do_if value="player.input.isinverted.flight.joystick.pitch">
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 2, 'invert_steering_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                </do_if>
                <do_else>
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 2, 'invert_steering_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                </do_else>
                <set_playership_throttle value="0"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipSteering_Stick_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_ShipSteering_Stick_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipSteering_Stick_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSteering_Stick"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSteering_MouseMode">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipSteering_MouseMode_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26401" comment="Press $INPUT_ACTION_TOGGLEMOUSESTEERING$ to turn on MOUSE STEERING."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1066}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSteering_MouseMode_TurnedOn" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.mousesteering.permanent"/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <show_help position="1" timeout="false" force="true" line="26402" comment="Your ship now steers towards your mouse cursor."/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1068}"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseMode_Yawing" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.mousesteering.permanent and (player.input.flight.yaw gt 0.5 or player.input.flight.yaw lt -0.5)"/>
              </conditions>
              <actions>
                <set_value name="$FlightSchool_ShipSteering_MouseMode_YawDone" exact="true"/>
                <do_if value="$FlightSchool_ShipSteering_MouseMode_PitchDone?">
                  <signal_cue cue="FlightSchool_ShipSteering_MouseMode_Invert"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseMode_Pitching" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.mousesteering.permanent and (player.input.flight.pitch gt 0.5 or player.input.flight.pitch lt -0.5)"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <set_value name="$FlightSchool_ShipSteering_MouseMode_PitchDone" exact="true"/>
                <do_if value="$FlightSchool_ShipSteering_MouseMode_YawDone?">
                  <signal_cue cue="FlightSchool_ShipSteering_MouseMode_Invert"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseMode_Invert">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <do_if value="player.input.isinverted.flight.mouse.pitch">
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 0, 'invert_mouse_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                </do_if>
                <do_else>
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 0, 'invert_mouse_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                </do_else>
                <set_playership_throttle value="0"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipSteering_MouseMode_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue cue="FlightSchool_ShipSteering_MouseMode_TurnOffMode"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_ShipSteering_MouseMode_TurnOffMode">
                  <conditions>
                    <check_any>
                      <event_cue_signalled/>
                    </check_any>
                  </conditions>
                  <actions>
                    <do_if value="player.input.mousesteering.permanent">
                      <show_help position="1" timeout="false" force="true" log="true" line="26403" comment="Press $INPUT_ACTION_TOGGLEMOUSESTEERING$ again to turn off MOUSE STEERING."/>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1067}"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ShipSteering_MouseMode_Off" checkinterval="0.1s">
                      <conditions>
                        <check_value value="not player.input.mousesteering.permanent"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                        <signal_cue cue="FlightSchool_ShipSteering_MouseMode_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseMode_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSteering_MouseMode"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSteering_MouseTemp">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipSteering_MouseTemp_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" log="true" line="26424" comment="You can also hold $INPUT_STATE_TOGGLEMOUSESTEERING$ to enable mouse steering until you release it."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSteering_MouseTemp_HintDisappeared">
              <conditions>
                <event_ui_triggered screen="'hintclosed'"/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_ShipSteering_MouseTemp_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseTemp_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSteering_MouseTemp"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSteering_Keyboard">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipSteering_Keyboard_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" log="true" line="26425" comment="$INPUT_STATE_STEER_LEFT$, $INPUT_STATE_STEER_RIGHT$, $INPUT_STATE_STEER_UP$ and $INPUT_STATE_STEER_DOWN$ also steer your ship."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSteering_Keyboard_HintDisappeared">
              <conditions>
                <event_ui_triggered screen="'hintclosed'"/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_ShipSteering_Keyboard_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_Keyboard_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSteering_Keyboard"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSteering_MouseDirect">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipSteering_MouseDirect_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26406" comment="Press $INPUT_ACTION_TOGGLEDIRECTMOUSESTEERING$ to turn on DIRECT MOUSE STEERING."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1066}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSteering_MouseDirect_TurnedOn" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.directmousesteering"/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <show_help position="1" timeout="false" force="true" line="26407" comment="Your ship now steers in the direction you move your mouse."/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1068}"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseDirect_Yawing" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.directmousesteering and (player.input.flight.yaw gt 0.5 or player.input.flight.yaw lt -0.5)"/>
              </conditions>
              <actions>
                <set_value name="$FlightSchool_ShipSteering_MouseDirect_YawDone" exact="true"/>
                <do_if value="$FlightSchool_ShipSteering_MouseDirect_PitchDone?">
                  <signal_cue cue="FlightSchool_ShipSteering_MouseDirect_Invert"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseDirect_Pitching" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.directmousesteering and (player.input.flight.pitch gt 0.5 or player.input.flight.pitch lt -0.5)"/>
              </conditions>
              <actions>
                <set_value name="$FlightSchool_ShipSteering_MouseDirect_PitchDone" exact="true"/>
                <do_if value="$FlightSchool_ShipSteering_MouseDirect_YawDone?">
                  <signal_cue cue="FlightSchool_ShipSteering_MouseDirect_Invert"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseDirect_Invert">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <do_if value="player.input.isinverted.flight.directmouse.pitch">
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 30, 'invert_direct_mouse_steering_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                </do_if>
                <do_else>
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 30, 'invert_direct_mouse_steering_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                </do_else>
                <set_playership_throttle value="0"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipSteering_MouseDirect_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue cue="FlightSchool_ShipSteering_MouseDirect_TurnOffMode"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_ShipSteering_MouseDirect_TurnOffMode">
                  <conditions>
                    <check_any>
                      <event_cue_signalled/>
                    </check_any>
                  </conditions>
                  <actions>
                    <do_if value="player.input.directmousesteering">
                      <show_help position="1" timeout="false" force="true" log="true" line="26408" comment="Press $INPUT_ACTION_TOGGLEDIRECTMOUSESTEERING$ again to turn off DIRECT MOUSE STEERING."/>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1067}"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ShipSteering_MouseDirect_Off" checkinterval="0.1s">
                      <conditions>
                        <check_value value="not player.input.directmousesteering"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                        <signal_cue cue="FlightSchool_ShipSteering_MouseDirect_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipSteering_MouseDirect_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSteering_MouseDirect"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipRoll_Precheck">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.controller or player.input.ismapped.controller.INPUT_RANGE_STEERING_ROLL or player.input.autoroll">
              <signal_cue cue="FlightSchool_ShipRoll_Precheck_Done"/>
            </do_if>
            <do_else>
              <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1109}, [ 'autoroll', {30178,1124}, true ], [ 'map', {30178,1125} ], 'autoroll' ]]"/>
              <set_playership_throttle value="0"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipRoll_Precheck_QuestionAnsweredOrClosed">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>
              <actions>
                <do_if value="event.param3 == 'map'">
                  <open_menu menu="OptionsMenu" param="'keyboard_space'"/>
                  <show_help position="5" allowinmenu="'OptionsMenu'" line="26426" comment="Select SECONDARY STEERING AXIS, press $INPUT_STATE_WIDGET_SELECT$, then move the axis you want to use."/>
                </do_if>
                <do_else>
                  <signal_cue cue="FlightSchool_ShipRoll_Precheck_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipRoll_Precheck_InputMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_ShipRoll_Precheck_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipRoll_Precheck_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipRoll_Precheck"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipRoll_AutoRoll">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.autoroll">
              <signal_cue cue="FlightSchool_ShipRoll_AutoRoll_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" log="true" line="26409" comment="Your ship automatically rolls to stay aligned with the ecliptic. This can be turned off in the options menu."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipRoll_AutoRoll_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'hintclosed'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipRoll_AutoRoll"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipRoll_Stick">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.autoroll or not player.input.ismapped.controller.INPUT_RANGE_STEERING_ROLL or not (player.input.joystick or player.input.controller)">
              <signal_cue cue="FlightSchool_ShipRoll_Stick_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26410" comment="Use $INPUT_RANGE_STEERING_ROLL$ to roll your ship."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1069}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipRoll_Stick_Rolling" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.input.mousesteering and not player.input.directmousesteering and (player.input.flight.roll gt 0.5 or player.input.flight.roll lt -0.5)"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <do_if value="player.input.isinverted.flight.joystick.roll">
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1111}, [ 'invert_off', {30178,1118}, 3, 'invert_steering_roll', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                </do_if>
                <do_else>
                  <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1113}, [ 'invert_on', {30178,1118}, 3, 'invert_steering_roll', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                </do_else>
                <set_playership_throttle value="0"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipRoll_Stick_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_ShipRoll_Stick_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipRoll_Stick_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipRoll_Stick"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipRoll_Keyboard">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.autoroll or player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipRoll_Keyboard_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26411" comment="Use $INPUT_STATE_ROLL_LEFT$ and $INPUT_STATE_ROLL_RIGHT$ to roll your ship."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1069}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipRoll_Keyboard_Rolling" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.input.mousesteering and not player.input.directmousesteering and (player.input.flight.roll gt 0.5 or player.input.flight.roll lt -0.5)"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_ShipRoll_Keyboard_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipRoll_Keyboard_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipRoll_Keyboard"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipStrafing">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Strafe', $endline = 2003 ]" />
            <do_if value="player.input.controller">
              <!--we need to handle several variations here, as any direction could be mapped to a button instead of an axis, so we need to display 2, 3 or 4 inputs, depending on the variation-->
              <create_list name="$StrafeInputNames"/>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_STRAFE_LEFT or player.input.ismapped.controller.INPUT_STATE_STRAFE_RIGHT">
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_LEFT$'"/>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_RIGHT$'"/>
              </do_if>
              <do_else>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_RANGE_STRAFE_LEFT_RIGHT$'"/>
              </do_else>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_STRAFE_UP or player.input.ismapped.controller.INPUT_STATE_STRAFE_DOWN">
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_UP$'"/>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_DOWN$'"/>
              </do_if>
              <do_else>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_RANGE_STRAFE_UP_DOWN$'"/>
              </do_else>
              <do_if value="$StrafeInputNames.count == 2">
                <substitute_text text="$StrafeHintText" source="{1012,26427}" comment="Use $INPUT1$ and $INPUT2$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                </substitute_text>
              </do_if>
              <do_elseif value="$StrafeInputNames.count == 3">
                <substitute_text text="$StrafeHintText" source="{1012,26428}" comment="Use $INPUT1$, $INPUT2$ and $INPUT3$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                  <replace string="'$INPUT3$'" with="$StrafeInputNames.{3}"/>
                </substitute_text>
              </do_elseif>
              <do_else>
                <substitute_text text="$StrafeHintText" source="{1012,26429}" comment="Use $INPUT1$, $INPUT2$, $INPUT3$ and $INPUT4$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                  <replace string="'$INPUT3$'" with="$StrafeInputNames.{3}"/>
                  <replace string="'$INPUT4$'" with="$StrafeInputNames.{4}"/>
                </substitute_text>
              </do_else>
              <show_help position="1" timeout="false" force="true" log="true" custom="$StrafeHintText"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26413" comment="Use $INPUT_STATE_STRAFE_LEFT$, $INPUT_STATE_STRAFE_RIGHT$, $INPUT_STATE_STRAFE_UP$ and $INPUT_STATE_STRAFE_DOWN$ to strafe."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1070}"/>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipStrafing_Vertical" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.vertical gt 0.5 or player.input.flight.vertical lt -0.5"/>
              </conditions>
              <actions>
                <set_value name="$FlightSchool_ShipStrafing_VerticalDone" exact="true"/>
                <do_if value="$FlightSchool_ShipStrafing_HorizontalDone?">
                  <signal_cue cue="FlightSchool_ShipStrafing_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipStrafing_Horizontal" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.horizontal gt 0.5 or player.input.flight.horizontal lt -0.5"/>
              </conditions>
              <actions>
                <set_value name="$FlightSchool_ShipStrafing_HorizontalDone" exact="true"/>
                <do_if value="$FlightSchool_ShipStrafing_VerticalDone?">
                  <signal_cue cue="FlightSchool_ShipStrafing_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipStrafing_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipStrafing"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipForward_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Forward', $endline = 2005 ]" />
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipForward_UseCase_Done">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="2004"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipForward_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipForward_Controller">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <debug_text text="'Using controller, showing help'" chance="$DebugChance"/>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_FULLFORWARD">
                <show_help position="1" timeout="false" force="true" log="true" line="26430" comment="Use $INPUT_STATE_FULLFORWARD$ to accelerate."/>
              </do_if>
              <do_else>
                <show_help position="1" timeout="false" force="true" log="true" line="26414" comment="Use $INPUT_RANGE_THROTTLE$ to accelerate."/>
              </do_else>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1072}"/>
            </do_if>
            <do_else>
              <debug_text text="'Not using controller, skipping'" chance="$DebugChance"/>
              <signal_cue cue="FlightSchool_ShipForward_Controller_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipForward_Controller_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.controller and player.input.flight.throttle gt 0.2 and $PlayerShip.relvelocity.z gt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipForward_Controller_Done"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipForward_Controller_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipForward_Controller"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipForward_Throttle">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.joystick">
              <debug_text text="'Using joystick, showing help'" chance="$DebugChance"/>
              <show_help position="1" timeout="false" force="true" log="true" line="26415" comment="Use $INPUT_RANGE_THROTTLE$ to set your speed."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1072}"/>
            </do_if>
            <do_else>
              <debug_text text="'Not using joystick, skipping'" chance="$DebugChance"/>
              <signal_cue cue="FlightSchool_ShipForward_Throttle_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipForward_Throttle_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.joystick and player.input.flight.throttle gt 0.2 and $PlayerShip.relvelocity.z gt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipForward_Throttle"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipForward_Throttle_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipForward_Throttle"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipForward_MouseWheel">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipForward_MouseWheel_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26416" comment="Use the mouse wheel or press $INPUT_STATE_ACCELERATE$ to accelerate."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1072}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipForward_Mousewheel_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.input.joystick and not player.input.controller and player.input.flight.throttle gt 0.2 and $PlayerShip.relvelocity.z gt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipForward_MouseWheel_Done"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipForward_MouseWheel_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipForward_MouseWheel"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipReverse_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpeedLimitAndReverse', $endline = 2007 ]" />
          </actions>
          <cues>
            <cue name="FlightSchool_ShipReverse_UseCase_Done">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="2006"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipReverse_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipReverse_Controller">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <debug_text text="'Using controller, showing help'" chance="$DebugChance"/>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_FULLREVERSE">
                <show_help position="1" timeout="false" force="true" log="true" line="26417" comment="Use $INPUT_STATE_FULLREVERSE$ to decelerate."/>
              </do_if>
              <do_else>
                <show_help position="1" timeout="false" force="true" log="true" line="26431" comment="Use $INPUT_RANGE_THROTTLE$ to decelerate."/>
              </do_else>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1073}"/>
            </do_if>
            <do_else>
              <debug_text text="'Not using controller, skipping'" chance="$DebugChance"/>
              <signal_cue cue="FlightSchool_ShipReverse_Controller_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipReverse_Controller_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.controller and player.input.flight.throttle lt -0.2 and $PlayerShip.relvelocity.z lt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipReverse_Controller_Done"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipReverse_Controller_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipReverse_Controller"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipReverse_Throttle">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.joystick">
              <debug_text text="'Using joystick, showing help'" chance="$DebugChance"/>
              <show_help position="1" timeout="false" force="true" log="true" line="26415" comment="Use $INPUT_RANGE_THROTTLE$ to set your speed."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1073}"/>
            </do_if>
            <do_else>
              <debug_text text="'Not using joystick, skipping'" chance="$DebugChance"/>
              <signal_cue cue="FlightSchool_ShipReverse_Throttle_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipReverse_Throttle_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.joystick and player.input.flight.throttle lt -0.2 and $PlayerShip.relvelocity.z lt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipReverse_Throttle"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipReverse_Throttle_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipReverse_Throttle"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipReverse_MouseWheel">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="FlightSchool_ShipReverse_MouseWheel_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26418" comment="Use the mouse wheel or press $INPUT_STATE_DECELERATE$ to decelerate."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1073}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipReverse_Mousewheel_Moving" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.input.joystick and not player.input.controller and player.input.flight.throttle lt -0.2 and $PlayerShip.relvelocity.z lt 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipReverse_MouseWheel_Done"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipReverse_MouseWheel_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipReverse_MouseWheel"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSpeed_FullStop">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick or player.input.flight.throttle == 0">
              <signal_cue cue="FlightSchool_ShipSpeed_FullStop_Done"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26419" comment="Press $INPUT_ACTION_STOP$ to come to a full stop."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1074}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSpeed_FullStop_Stopped" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.throttle == 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_ShipSpeed_FullStop_Done"/>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShipSpeed_FullStop_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSpeed_FullStop"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Camera_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Camera', $endline = 3001 ]" />
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
          </actions>
          <cues>
            <cue name="FlightSchool_Camera_UseCase_Done">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="3001"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Camera_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_CockpitCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="FlightSchool_CockpitCamera_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_CockpitLook', $endline = 3002 ]" />
              <show_help position="1" timeout="false" force="true" log="true" line="26500" comment="Use the numpad to look around."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1080}"/>
              <set_value name="$CockpitLookUsecaseSpoken" exact="true"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_CockpitCamera_LookingAround" checkinterval="0.1s">
              <conditions>
                <check_value value="player.camera.yaw != 0deg or player.camera.pitch != 0deg"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_CockpitCamera_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_CockpitCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_CockpitCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ExternalCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_control_mode_messages_disabled/>
            <do_if value="$CockpitLookUsecaseSpoken?">
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ExternalCamera', $endline = 3003 ]" />
            </do_if>
            <do_else>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ExternalCamera_NoCockpitLook', $endline = 3012 ]" />
            </do_else>
            <do_if value="player.input.controller">
              <show_help position="1" timeout="false" force="true" log="true" line="26501" comment="Press $INPUT_ACTION_CYCLE_VIEW$ to go to EXTERNAL VIEW."/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26502" comment="Press $INPUT_ACTION_EXTERNAL_VIEW$ to go to EXTERNAL VIEW."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1081}"/>
          </actions>
          <cues>
            <cue name="FlightSchool_ExternalCamera_Activated">
              <conditions>
                <event_player_activated_external_view/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ExternalCamera_FlyAround', $endline = 3004 ]" />
                <remove_help all="true"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1075}"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ExternalCamera_Delay">
                  <delay exact="10s"/>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ExternalCamera_OtherMode', $endline = 3005 ]" />
                    <do_if value="player.input.controller">
                      <show_help position="1" timeout="false" force="true" log="true" line="26503" comment="Press $INPUT_ACTION_CYCLE_VIEW$ to change EXTERNAL VIEW mode."/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" log="true" line="26504" comment="Press $INPUT_ACTION_EXTERNAL_VIEW$ to change EXTERNAL VIEW mode."/>
                    </do_else>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1082}"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_ExternalCamera_ModeChanged">
                  <conditions>
                    <event_player_activated_external_view/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <remove_help all="true"/>
                    <cancel_cue cue="FlightSchool_ExternalCamera_Delay"/>
                    <do_if value="player.input.controller">
                      <cancel_cue cue="FlightSchool_ExternalCamera_Rotated"/>
                      <cancel_cue cue="FlightSchool_ExternalCamera_Zoomed"/>
                      <signal_cue cue="FlightSchool_ExternalCamera_ReturnToCockpit"/>
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ExternalCamera_Controls', $endline = 3006 ]" />
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1079}"/>
                      <show_help position="1" timeout="false" force="true" log="true" line="26505" comment="Use the numpad to look around, press $INPUT_STATE_CAMERA_ZOOMIN$ and $INPUT_STATE_CAMERA_ZOOMOUT$ to zoom in and out."/>
                      <set_value name="$StartCameraYaw" exact="player.camera.yaw"/>
                      <set_value name="$StartCameraPitch" exact="player.camera.pitch"/>
                      <set_value name="$StartCameraZoom" exact="player.camera.zoom"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ExternalCamera_Rotated" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$StartCameraYaw? and $StartCameraPitch? and player.camera.yaw != $StartCameraYaw and player.camera.pitch != $StartCameraPitch"/>
                      </conditions>
                      <actions>
                        <set_value name="$FlightSchool_ExternalCamera_Rotated_Done" exact="true"/>
                        <do_if value="$FlightSchool_ExternalCamera_Zoomed_Done?">
                          <signal_cue cue="FlightSchool_ExternalCamera_ReturnToCockpit"/>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_ExternalCamera_Zoomed" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$StartCameraZoom? and player.camera.zoom != $StartCameraZoom"/>
                      </conditions>
                      <actions>
                        <set_value name="$FlightSchool_ExternalCamera_Zoomed_Done" exact="true"/>
                        <do_if value="$FlightSchool_ExternalCamera_Rotated_Done?">
                          <signal_cue cue="FlightSchool_ExternalCamera_ReturnToCockpit"/>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_ExternalCamera_ReturnToCockpit">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <delay exact="2s"/>
                      <actions>
                        <remove_help all="true"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ReturnToCockpitView_1', $endline = 3007 ]" />
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1084}"/>
                        <do_if value="player.input.controller">
                          <show_help position="1" timeout="false" force="true" log="true" line="26506" comment="Press $INPUT_ACTION_CYCLE_VIEW$ to return to COCKPIT VIEW."/>
                        </do_if>
                        <do_else>
                          <show_help position="1" timeout="false" force="true" log="true" line="26507" comment="Press $INPUT_ACTION_COCKPIT_VIEW$ to return to COCKPIT VIEW."/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_ExternalCamera_ReturnedToCockpit">
                          <conditions>
                            <event_player_activated_cockpit_view/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <signal_cue cue="FlightSchool_ExternalCamera_Done"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ExternalCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <reset_control_mode_messages/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ExternalCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FloatingCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="FlightSchool_FloatingCamera_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FloatingCamera', $endline = 3008 ]" />
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1083}"/>
              <show_help position="1" timeout="false" force="true" log="true" line="26508" comment="Press $INPUT_ACTION_FLOATING_VIEW$ to activate FLOATING VIEW."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_FloatingCamera_Activated">
              <conditions>
                <event_player_activated_floating_view/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_FloatingCamera_Controls', $endline = 3009 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1078}"/>
                <show_help position="1" timeout="false" force="true" line="26505" comment="Use the numpad to look around, press $INPUT_STATE_CAMERA_ZOOMIN$ and $INPUT_STATE_CAMERA_ZOOMOUT$ to zoom in and out."/>
                <set_value name="$StartCameraYaw" exact="player.camera.yaw"/>
                <set_value name="$StartCameraPitch" exact="player.camera.pitch"/>
              </actions>
              <cues>
                <cue name="FlightSchool_FloatingCamera_LookingAround" checkinterval="0.1s">
                  <conditions>
                    <check_value value="(player.camera.yaw gt $StartCameraYaw + 1deg or player.camera.yaw lt $StartCameraYaw - 1deg) and (player.camera.pitch gt $StartCameraPitch + 1deg or player.camera.pitch lt $StartCameraPitch - 1deg)"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <remove_help all="true"/>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1084}"/>
                    <show_help position="1" timeout="false" force="true" log="true" line="26507" comment="Press $INPUT_ACTION_COCKPIT_VIEW$ to return to COCKPIT VIEW."/>
                  </actions>
                </cue>

                <cue name="FlightSchool_FloatingCamera_ReturnedToCockpit">
                  <conditions>
                    <event_player_activated_cockpit_view/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_FloatingCamera_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FloatingCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FloatingCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ToggleCockpit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="FlightSchool_ToggleCockpit_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ToggleCockpit', $endline = 3011 ]" />
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1085}"/>
              <show_help position="1" timeout="false" force="true" log="true" line="26600" comment="Press $INPUT_ACTION_TOGGLECOCKPIT$ to hide the cockpit."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ToggleCockpit_ToggledCockpit">
              <conditions>
                <event_player_toggled_cockpit/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <show_help position="1" log="true" line="26601" comment="Press $INPUT_ACTION_TOGGLECOCKPIT$ to show the cockpit again."/>
                <signal_cue cue="FlightSchool_ToggleCockpit_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ToggleCockpit_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ToggleCockpit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_TestCourse">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$PlayerShip.speedlimit ge 0">
              <signal_cue cue="FlightSchool_TestCourse_LeaveDockArea"/>
            </do_if>
            <do_else>
              <signal_cue cue="FlightSchool_TestCourse_Setup"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_TestCourse_LeaveDockArea">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_LeaveDockArea', $endline = 4001 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1086}"/>
              </actions>
              <cues>
                <cue name="FlightSchool_TestCourse_DockAreaLeft" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$PlayerShip.speedlimit lt 0"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_TestCourse_Setup"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TestCourse_Setup">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_StartObstacleCourse', $endline = 4005 ]" />
                <!--create a sequence of nav beacons for the player to fly past-->
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                  <position object="$Station" x="525" y="165" z="1330"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t2_macro" sector="$PlayerShip.sector">
                  <position object="$Station" x="525" y="225" z="-285"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t3_macro" sector="$PlayerShip.sector">
                  <position object="$Station" x="270" y="275" z="-1690"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t4_macro" sector="$PlayerShip.sector">
                  <position object="$Station" x="-815" y="40" z="-30"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t5_macro" sector="$PlayerShip.sector">
                  <position object="$Station" x="-773" y="-75" z="2390"/>
                </create_object>
                <set_value name="$TotalNumBeacons" exact="$FlyToBeacons.count"/>
                <set_value name="$FastFinish" exact="true"/>
                <signal_cue cue="FlightSchool_TestCourse_UpdateObjective"/>
              </actions>
              <cues>
                <cue name="FlightSchool_TestCourse_UpdateObjective" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$FlyToBeacons.{1}">
                      <progress text="{30178,1096}" progress="$TotalNumBeacons - $FlyToBeacons.count" max="$TotalNumBeacons" />
                    </set_objective>
                  </actions>
                </cue>

                <cue name="FlightSchool_TestCourse_TargetReached" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$FlyToBeacons? and $PlayerShip.distanceto.{$FlyToBeacons.{1}} lt 100m"/>
                  </conditions>
                  <actions>
                    <set_value name="$ReachedBeacon" exact="$FlyToBeacons.{1}"/>
                    <remove_from_group group="$FlyToBeacons" object="$ReachedBeacon"/>
                    <destroy_object object="$ReachedBeacon"/>
                    <do_if value="$FlyToBeacons.count">
                      <signal_cue cue="FlightSchool_TestCourse_UpdateObjective"/>
                      <signal_cue cue="FlightSchool_TestCourse_Boost" check="false"/>
                      <signal_cue cue="FlightSchool_TestCourse_Timer" check="false"/>
                      <reset_cue cue="this"/>
                      <do_if value="$FastFinish?">
                        <reset_cue cue="FlightSchool_TestCourse_TimeCheck"/>
                      </do_if>
                    </do_if>
                    <do_else>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                      <signal_cue cue="FlightSchool_TestCourse_Done"/>
                    </do_else>
                  </actions>
                </cue>

                <cue name="FlightSchool_TestCourse_Timer">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <cues>
                    <cue name="FlightSchool_TestCourse_TimeCheck" checktime="player.age + 10s">
                      <actions>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ObstacleCourse_NoTimer', $endline = 4006 ]" />
                        <remove_value name="$FastFinish"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_TestCourse_Boost">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ObstacleCourse_Boost', $endline = 4007 ]" />
                    <do_if value="player.input.boosttoggle">
                      <show_help position="1" timeout="false" force="true" log="true" line="2020" comment="Press $INPUT_STATE_BOOST$ to start boosting and travel longer distances in a shorter time."/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" log="true" line="2021" comment="Hold $INPUT_STATE_BOOST$ to start boosting and travel longer distances in a shorter time."/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Boosting_Started">
                      <conditions>
                        <event_player_boost_started/>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ObstacleCourse_Boosted', $endline = 4009 ]" />
                        <remove_help all="true"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TestCourse_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="$FastFinish?">
                  <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_ObstacleCourse_FastFinish', $endline = 4010 ]" />
                </do_if>
                <cancel_cue cue="FlightSchool_TestCourse_TimeCheck"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSpeed_FullStop"/>
                <cancel_cue cue="FlightSchool_TestCourse"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_TravelMode_RestartHelper" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
            <signal_cue cue="FlightSchool_TravelMode"/>
          </actions>
        </cue>

        <cue name="FlightSchool_TravelMode">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="not $FlightSchool_TravelMode_Repeat?">
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Intro', $endline = 5002 ]" />
            </do_if>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Align', $endline = 5003 ]" />
            <do_if value="not @$FlyToBeacon.exists">
              <create_object name="$FlyToBeacon" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                <position x="10000km"/>
              </create_object>
            </do_if>
          </actions>
          <cues>
            <cue name="FlightSchool_TravelMode_PrematureStart">
              <conditions>
                <check_any>
                  <event_player_travelmode_charge_started/>
                  <event_player_travelmode_started/>
                </check_any>
                <check_value value="@$FlyToBeacon.exists"/>
                <check_object object="$FlyToBeacon">
                  <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg" negate="true"/>
                </check_object>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TooEarlyTryAgain', $endlines = [6, 7, 8] ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1091}"/>
              </actions>
              <cues>
                <cue name="FlightSchool_TravelMode_PrematureStart_Recovery">
                  <conditions>
                    <check_any>
                      <event_player_travelmode_stopped/>
                      <event_player_travelmode_charge_aborted/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_TravelMode_ActivateAlignObjective"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TravelMode_ActivateAlignObjective" instantiate="true">
              <conditions>
                <check_any>
                  <event_speak_finished actor="$FlightInstructor" line="5001"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1089}" object="$FlyToBeacon"/>
              </actions>
            </cue>

            <cue name="FlightSchool_TravelMode_StartAlignmentChecks">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="5003"/>
              </conditions>
              <cues>
                <cue name="FlightSchool_TravelMode_Aligned" checkinterval="0.1s">
                  <conditions>
                    <check_value value="@$FlyToBeacon.exists"/>
                    <check_object object="$FlyToBeacon">
                      <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg"/>
                    </check_object>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <cancel_cue cue="FlightSchool_TravelMode_ActivateAlignObjective"/>
                    <cancel_cue cue="FlightSchool_TravelMode_PrematureStart"/>
                    <do_if value="$PlayerShip.travel.charging or $PlayerShip.travel.active">
                      <do_if value="not $FlightSchool_TravelMode_Repeat?">
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AlreadyFamiliar', $endlines = [10, 11] ]" />
                      </do_if>
                      <signal_cue cue="FlightSchool_TravelMode_Started"/>
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Activate', $endline = 5005 ]" />
                      <show_help position="1" timeout="false" force="true" log="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                      <remove_help_overlay all="true"/>
                      <show_help_overlay id="'docked_modes'" highlightonly="true"/>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1090}" object="$FlyToBeacon"/>
                      <set_value name="$TravelModeHintActive" exact="true"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_TravelMode_MoveHint" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'"/>
                      </conditions>
                      <actions>
                        <do_if value="$TravelModeHintActive?">
                          <remove_help all="true"/>
                          <do_if value="event.param2 == ''">
                            <show_help position="4" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_if>
                          <do_elseif value="event.param2 == 'menu_close'">
                            <show_help position="1" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_elseif>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_TravelMode_Activated">
                      <conditions>
                        <check_any>
                          <event_player_travelmode_charge_started/>
                          <event_player_travelmode_started/>
                        </check_any>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <remove_help_overlay id="'docked_modes'"/>
                        <remove_value name="$TravelModeHintActive"/>
                        <do_if value="$ShipMenuOpen?">
                          <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                        </do_if>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_TravelMode_MenuClosed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <do_if value="$PlayerShip.travel.active">
                              <signal_cue cue="FlightSchool_TravelMode_Started" check="false"/>
                            </do_if>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="FlightSchool_TravelMode_Started">
                      <conditions>
                        <check_any>
                          <event_cue_signalled/>
                          <check_all>
                            <event_player_travelmode_started/>
                            <check_value value="not $ShipMenuOpen?"/>
                          </check_all>
                        </check_any>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <set_value name="$TargetSpeed" exact="$PlayerShip.travel.maxspeed * 0.99"/>
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1076}" object="$FlyToBeacon">
                          <progress progress="0" max="100"/>
                        </set_objective>
                        <do_if value="not $FlightSchool_TravelMode_Repeat?">
                          <do_if value="not player.input.controller">
                            <show_help position="1" log="true" line="26701" comment="The keyboard shortcut for TRAVEL MODE is $INPUT_ACTION_TOGGLE_TRAVEL_MODE$."/>
                          </do_if>
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Activated', $endline = 5025 ]" />
                        </do_if>
                        <!--TODO: temporarily disable Full Stop?-->
                      </actions>
                      <cues>
                        <cue name="FlightSchool_TravelMode_StoppedTooEarly">
                          <conditions>
                            <event_player_travelmode_stopped/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TooEarlyTryAgain', $endlines = [6, 7, 8] ]" />
                            <set_value name="$FlightSchool_TravelMode_Repeat" exact="true"/>
                            <reset_cue cue="FlightSchool_TravelMode"/>
                            <signal_cue cue="FlightSchool_TravelMode_RestartHelper"/>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_TravelMode_GainSpeedObjective">
                          <delay exact="1ms"/>
                          <actions>
                            <update_objective_progress cue="X4ep1_Gamestart_FlightSchool" progress="1000 * $PlayerShip.speed / $TargetSpeed" max="1000"/>
                            <reset_cue cue="this"/>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_TravelMode_GainedSpeed" checkinterval="0.1s">
                          <conditions>
                            <check_value value="$PlayerShip.speed ge $PlayerShip.travel.maxspeed * 0.99"/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <cancel_cue cue="FlightSchool_TravelMode_StoppedTooEarly"/>
                            <cancel_cue cue="FlightSchool_TravelMode_GainSpeedObjective"/>
                            <do_if value="not $FlightSchool_TravelMode_Repeat?">
                              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_GainedSpeed', $endline = 5009 ]" />
                            </do_if>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_StartCoasting', $endline = 5010 ]" />
                            <show_help_overlay id="'docked_stopmode'" highlightonly="true"/>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                          </actions>
                          <cues>
                            <cue name="FlightSchool_TravelMode_StopMode_Speak_Finished">
                              <conditions>
                                <event_speak_finished actor="$FlightInstructor" line="5009"/>
                              </conditions>
                              <actions>
                                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1091}"/>
                                <show_help position="1" timeout="false" force="true" log="true" line="26705" comment="To deactivate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                <remove_help_overlay all="true"/>
                                <show_help_overlay id="'docked_stopmode'" highlightonly="true"/>
                                <set_value name="$TravelModeHintActive" exact="true"/>
                              </actions>
                              <cues>
                                <cue name="FlightSchool_TravelMode_StopMode_MoveHint" instantiate="true">
                                  <conditions>
                                    <event_ui_triggered screen="'DockedMenu'"/>
                                  </conditions>
                                  <actions>
                                    <do_if value="$TravelModeHintActive?">
                                      <remove_help all="true"/>
                                      <do_if value="event.param2 == ''">
                                        <show_help position="4" timeout="false" force="true" line="26705" comment="To deactivate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                      </do_if>
                                      <do_elseif value="event.param2 == 'menu_close'">
                                        <show_help position="1" timeout="false" force="true" line="26705" comment="To deactivate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                      </do_elseif>
                                    </do_if>
                                  </actions>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>

                        <cue name="FlightSchool_TravelMode_Stopped">
                          <conditions>
                            <event_player_travelmode_stopped/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <cancel_cue cue="FlightSchool_TravelMode_StopMode_Speak_Finished"/>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                            <do_if value="$PlayerShip.travel.iscoasting">
                              <remove_value name="$FlightSchool_TravelMode_Repeat"/>
                              <signal_cue cue="FlightSchool_TravelMode_Coasting"/>
                            </do_if>
                            <do_else>
                              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_WrongActionTryAgain', $endlines = [6, 7, 8] ]" />
                              <set_value name="$FlightSchool_TravelMode_Repeat" exact="true"/>
                              <reset_cue cue="FlightSchool_TravelMode"/>
                              <signal_cue cue="FlightSchool_TravelMode_RestartHelper"/>
                            </do_else>
                            <remove_help all="true"/>
                            <remove_help_overlay id="'docked_modes'"/>
                            <remove_value name="$TravelModeHintActive"/>
                            <do_if value="$ShipMenuOpen?">
                              <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                            </do_if>
                          </actions>
                          <cues>
                            <cue name="FlightSchool_TravelMode_Stopped_MenuClosed">
                              <conditions>
                                <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                              </conditions>
                              <actions>
                                <remove_help all="true"/>
                                <do_if value="$FlightSchool_TravelMode_Repeat?">
                                  <reset_cue cue="FlightSchool_TravelMode"/>
                                  <signal_cue cue="FlightSchool_TravelMode_RestartHelper"/>
                                </do_if>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TravelMode_Coasting">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_stopmode'"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Coasting_SpeedAndSteering', $endline = 5013 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
              </actions>
              <cues>
                <cue name="FlightSchool_TravelMode_Coasting_SteerShipObjective">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="5012"/>
                  </conditions>
                  <actions>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1077}"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_TravelMode_Rotated" checkinterval="0.1s">
                  <conditions>
                    <check_value value="@$FlyToBeacon.exists"/>
                    <check_object object="$FlyToBeacon">
                      <match_is_in_view_of object="player.ship" vertical="45deg" horizontal="45deg" negate="true"/>
                    </check_object>
                  </conditions>
                  <actions>
                    <cancel_cue cue="FlightSchool_TravelMode_Coasting_SteerShipObjective"/>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Coasting_NewtonianAndStopping', $endline = 5015 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_TravelMode_Coasting_DecelerateObjective">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="5015"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Coasting_NewtonianAndStopping_Instruction', $endline = 5016 ]" />
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1073}"/>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_TravelMode_CoastingAborted" checkinterval="0.1s">
                      <conditions>
                        <check_value value="not $PlayerShip.travel.iscoasting"/>
                      </conditions>
                      <actions>
                        <cancel_cue cue="FlightSchool_TravelMode_Coasting_DecelerateObjective"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Coasting_StopNewtonian', $endline = 5017 ]" />
                      </actions>
                      <cues>
                        <cue name="FlightSchool_TravelMode_Coasting_StrafeObjective">
                          <conditions>
                            <event_speak_finished actor="$FlightInstructor" line="5017"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_Coasting_StopNewtonian_Instruction', $endline = 5018 ]" />
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1071}"/>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_TravelMode_FlightAssistRestored" checkinterval="0.1s">
                          <conditions>
                            <check_value value="player.flightassist"/>
                          </conditions>
                          <actions>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                            <cancel_cue cue="FlightSchool_TravelMode_Coasting_StrafeObjective"/>
                            <signal_cue cue="FlightSchool_TravelMode_QuickAbort"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TravelMode_QuickAbort">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_QuickAbort_ActivateMode', $endline = 5021 ]" />
              </actions>
              <cues>
                <cue name="FlightSchool_TravelMode_QuickAbort_StartModeObjective">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="5020"/>
                  </conditions>
                  <actions>
                    <do_if value="not $PlayerShip.travel.active">
                      <show_help position="1" timeout="false" force="true" log="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                      <remove_help_overlay all="true"/>
                      <show_help_overlay id="'docked_modes'" highlightonly="true"/>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1090}"/>
                      <set_value name="$TravelModeHintActive" exact="true"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_TravelMode_QuickAbort_MoveHint" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'"/>
                      </conditions>
                      <actions>
                        <do_if value="$TravelModeHintActive?">
                          <remove_help all="true"/>
                          <do_if value="event.param2 == ''">
                            <show_help position="4" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_if>
                          <do_elseif value="event.param2 == 'menu_close'">
                            <show_help position="1" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_elseif>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_TravelMode_QuickAbort_Activated">
                      <conditions>
                        <check_any>
                          <event_player_travelmode_charge_started/>
                          <event_player_travelmode_started/>
                        </check_any>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <remove_help_overlay id="'docked_modes'"/>
                        <remove_value name="$TravelModeHintActive"/>
                        <do_if value="$ShipMenuOpen?">
                          <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                        </do_if>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_TravelMode_QuickAbort_MenuClosed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_TravelMode_QuickAbort_Started">
                  <conditions>
                    <event_player_travelmode_started/>
                  </conditions>
                  <actions>
                    <cancel_cue cue="FlightSchool_TravelMode_QuickAbort_StartModeObjective"/>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_QuickAbort_ModeStarted', $endline = 5022 ]" />
                    <set_value name="$TargetSpeed" exact="$PlayerShip.travel.maxspeed * 0.33"/>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1076}">
                      <progress progress="0" max="100"/>
                    </set_objective>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_TravelMode_QuickAbort_GainSpeedObjective">
                      <delay exact="1ms"/>
                      <actions>
                        <update_objective_progress cue="X4ep1_Gamestart_FlightSchool" progress="1000 * $PlayerShip.speed / $TargetSpeed" max="1000"/>
                        <reset_cue cue="this"/>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_TravelMode_QuickAbort_GainedSpeed" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$PlayerShip.speed ge $TargetSpeed"/>
                      </conditions>
                      <actions>
                        <cancel_cue cue="FlightSchool_TravelMode_QuickAbort_GainSpeedObjective"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_TravelMode_QuickAbort_GainedSpeed', $endline = 5026 ]" />
                        <do_if value="player.input.controller">
                          <show_help position="1" timeout="false" force="true" line="26703" comment="Press $INPUT_STATE_FULLREVERSE$ to come to a quicker stop."/>
                        </do_if>
                        <do_else>
                          <show_help position="1" timeout="false" force="true" line="26704" comment="Press $INPUT_ACTION_STOP$ to come to a quicker stop."/>
                        </do_else>
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1092}"/>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_TravelMode_QuickAbort_Stopped" checkinterval="0.1s">
                          <conditions>
                            <check_value value="$PlayerShip.speed == 0"/>
                          </conditions>
                          <actions>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                            <remove_help all="true"/>
                            <signal_cue cue="FlightSchool_TravelMode_Done"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_TravelMode_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <destroy_object object="$FlyToBeacon" explosion="false"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_TravelMode"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_AutoPilot_Start">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AutoPilot', $endline = 6001 ]" />
            <create_ship name="$MatchSpeedShip" macro="$MatchSpeedShipMacro" sector="player.sector" capturable="false">
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <owner exact="$AlliedFaction" overridenpc="true"/>
              <position x="-50km" y="25km" z="-100km" space="player.sector"/>
            </create_ship>
            <create_order object="$MatchSpeedShip" id="'Wait'" immediate="true">
              <param name="noattackresponse" value="true"/>
            </create_order>
            <create_position name="$AutoPilotTargetOffset" object="$MatchSpeedShip" x="-500m" z="-250m" space="$MatchSpeedShip.sector"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$MatchSpeedShip.sector" offset="$AutoPilotTargetOffset"/>
            <show_help position="1" timeout="false" force="true" log="true" line="26802" comment="To activate the AUTO PILOT, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
            <set_value name="$AutoPilotHintActive" exact="true"/>
            <show_help_overlay id="'docked_autopilot'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="FlightSchool_AutoPilot_MoveHint" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'"/>
              </conditions>
              <actions>
                <do_if value="$AutoPilotHintActive?">
                  <remove_help all="true"/>
                  <do_if value="event.param2 == ''">
                    <show_help position="4" timeout="false" force="true" line="26802" comment="To activate the AUTO PILOT, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                  </do_if>
                  <do_elseif value="event.param2 == 'menu_close'">
                    <show_help position="1" timeout="false" force="true" line="26802" comment="To activate the AUTO PILOT, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                  </do_elseif>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_AutoPilot_Activated">
              <conditions>
                <event_autopilot_target_set/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AutoPilot_Started', $endline = 6006 ]" />
                <remove_help all="true"/>
                <remove_help_overlay id="'docked_autopilot'"/>
                <do_if value="not player.input.controller">
                  <show_help position="1" log="true" line="26803" comment="You can also press $INPUT_ACTION_TOGGLE_AUTOPILOT$ as a shortcut."/>
                </do_if>
              </actions>
              <cues>
                <cue name="FlightSchool_AutoPilot_SpeaksFinished">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="6006"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_AutoPilot_Start_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_AutoPilot_Start_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_AutoPilot_Start"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Logbook">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Logbook_OpenMenu', $endline = 16001 ]" />
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="FlightSchool_Logbook_ShipMenuOpened"/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="26900" comment="Press $INPUT_ACTION_OPEN_COCKPIT_MENU$ to open the SHIP MENU."/>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1088}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_Logbook_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Logbook_ShipMenuOpened', $endline = 16002 ]" />
                <remove_help all="true"/>
                <show_help position="4" timeout="false" force="true" log="true" line="26901" comment="Press $INPUT_ACTION_WIDGET_TABSCROLL_LEFT$ and $INPUT_ACTION_WIDGET_TABSCROLL_RIGHT$ to change tabs. Go to the highlighted PLAYER INFORMATION tab."/>
                <show_help_overlay id="'toplevel_playerinfo'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_Logbook_PlayerInfoMenuOpened">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'" control="''"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Logbook_PlayerInfoMenuOpened', $endline = 16003 ]" />
                <remove_help all="true"/>
                <remove_help_overlay id="'toplevel_playerinfo'"/>
                <show_help_overlay id="'playerinfo_sidebar_logbook'" highlightonly="true"/>
                <show_help position="4" timeout="false" force="true" log="true" line="26902" comment="Press $INPUT_ACTION_WIDGET_BACK$ to activate the sidebar, then scroll down to the logbook and press $INPUT_STATE_WIDGET_SELECT$."/>
              </actions>
            </cue>

            <cue name="FlightSchool_Logbook_Opened">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'" control="'logbook'"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Logbook_LogbookOpened', $endline = 16006 ]" />
                <remove_help all="true"/>
                <remove_help_overlay id="'playerinfo_sidebar_logbook'"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Logbook_ShowCloseHint">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="16005"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                  </actions>
                </cue>

                <cue name="FlightSchool_Logbook_Closed">
                  <conditions>
                    <event_ui_triggered screen="'PlayerInfoMenu'" control="'menu_close'"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_Logbook_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Logbook_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Logbook"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_AutoPilot_Finish">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="@$MatchSpeedShip.exists and $PlayerShip.distanceto.{$MatchSpeedShip} lt 2km">
              <signal_cue cue="FlightSchool_AutoPilot_Finish_Done"/>
            </do_if>
            <do_else>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$MatchSpeedShip.sector" offset="$AutoPilotTargetOffset"/>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AutoPilot_MayAbort', $endline = 6004 ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_AutoPilot_FinishCheck" checkinterval="0.1s">
              <conditions>
                <check_value value="@$MatchSpeedShip.exists and $PlayerShip.distanceto.{$MatchSpeedShip} lt 2km"/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_AutoPilot_Finish_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_AutoPilot_Finish_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AutoPilot_Arrived', $endline = 6005 ]" />
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_AutoPilot_Finish"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Targeting">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Target', $endline = 7002 ]" />
            <do_if value="player.input.controller">
              <show_help position="1" timeout="false" force="true" log="true" line="27000" comment="Pointing your ship at a target automatically selects it. Make the nearby ship your target now."/>
            </do_if>
            <do_elseif value="player.input.joystick">
              <show_help position="1" timeout="false" force="true" log="true" line="27001" comment="Point towards the nearby ship then press $INPUT_ACTION_TARGET_NEXT_TARGET$ to make it your target."/>
            </do_elseif>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="27002" comment="Click on the nearby ship to make it your target."/>
            </do_else>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.follow" object="$MatchSpeedShip"/>
            <do_if value="player.target == $MatchSpeedShip">
              <signal_cue cue="FlightSchool_Targeting_Done_ExtraDelay"/>
            </do_if>
          </actions>
          <cues>
            <cue name="FlightSchool_Targeting_Done_ExtraDelay">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="3s"/>
              <actions>
                <signal_cue cue="FlightSchool_Targeting_Done"/>
              </actions>
            </cue>

            <cue name="FlightSchool_Targeting_Done">
              <conditions>
                <check_any>
                  <event_player_changed_target target="$MatchSpeedShip"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <delay exact="0.5s"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Targeting"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShipSpeed_MatchTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_MatchSpeed', $endline = 7003 ]" />
            <create_position name="$MatchTarget_MoveToPosition" z="400km" object="$MatchSpeedShip" space="$MatchSpeedShip.sector"/>
            <create_order object="$MatchSpeedShip" id="'MoveGeneric'" name="$order" immediate="true">
              <param name="destination" value="$MatchSpeedShip.sector"/>
              <param name="position" value="$MatchTarget_MoveToPosition"/>
              <param name="precise" value="true"/>
              <param name="noboost" value="true"/>
            </create_order>
            <do_if value="player.input.controller">
              <show_help position="1" timeout="false" force="true" log="true" line="27800" comment="To MATCH SPEED, select it via the INTERACT MENU ($INPUT_STATE_INTERACTION_MENU$)."/>
            </do_if>
            <do_else>
              <show_help position="1" timeout="false" force="true" log="true" line="27801" comment="Press $INPUT_STATE_MATCH_SPEED$ to start matching the speed of your current target."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_ShipSpeed_MatchTarget_MatchingSpeed" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.matchspeed"/>
              </conditions>
              <delay exact="5s"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_MatchSpeed_Activated', $endline = 7004 ]" />
                <remove_help all="true"/>
                <do_if value="player.input.controller">
                  <show_help position="1" log="true" line="27802" comment="To stop MATCHING SPEED, select it via the INTERACT MENU ($INPUT_STATE_INTERACTION_MENU$)."/>
                </do_if>
                <do_else>
                  <show_help position="1" log="true" line="27803" comment="Press $INPUT_STATE_MATCH_SPEED$ again to stop MATCHING SPEED."/>
                </do_else>
              </actions>
              <cues>
                <cue name="FlightSchool_ShipSpeed_MatchTarget_UseCaseDone">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="7004"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                    <create_order object="$MatchSpeedShip" id="'MoveDie'" default="true"/>
                    <signal_cue cue="FlightSchool_ShipSpeed_MatchTarget_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShipSpeed_MatchTarget_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <destroy_object object="$MatchSpeedShip"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShipSpeed_MatchTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Shooting_TargetHelper">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_all exact="4" counter="$i">
              <create_ship groupname="$ShootTargets" macro="$TargetPracticeFlimsyMacro" sector="$PlayerShip.sector" capturable="false">
                <owner exact="faction.ownerless" overridenpc="true" />
                <pilot>
                  <select race="race.drone" tags="tag.aipilot"/>
                </pilot>
                <safepos object="player.ship" x="300m * $i * $i" z="$PlayerShip.maxcombatrange.primary * 0.75 * $i"/>
              </create_ship>
              <set_relation_boost object="$ShootTargets.{$i}" value="-1" faction="faction.player" silent="true"/>
              <set_object_relation_behaviour object="$ShootTargets.{$i}" disable="true"/>
              <create_order object="$ShootTargets.{$i}" id="'Wait'" immediate="true">
                <param name="noattackresponse" value="true"/>
              </create_order>
            </do_all>
          </actions>
          <cues>
            <cue name="FlightSchool_Shooting_TargetHelper_MakeTargetsMove">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_value name="$ShootTargetsMoving" exact="true"/>
                <do_all exact="$ShootTargets.count" counter="$i">
                  <start_script name="'move.random'" object="$ShootTargets.{$i}.pilot">
                    <param name="MaxDistance" value="5km"/>
                  </start_script>
                </do_all>
              </actions>
            </cue>

            <cue name="FlightSchool_Shooting_TargetHelper_TargetDestroyed" instantiate="true">
              <conditions>
                <event_object_destroyed group="$ShootTargets"/>
              </conditions>
              <actions>
                <create_ship groupname="$ShootTargets" macro="$TargetPracticeFlimsyMacro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <safepos object="player.ship" x="[-500m, 500m].random" z="$PlayerShip.maxcombatrange.primary * 0.75"/>
                </create_ship>
                <set_relation_boost object="$ShootTargets.{$ShootTargets.count}" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$ShootTargets.{$ShootTargets.count}" disable="true"/>
                <do_if value="$ShootTargetsMoving?">
                  <start_script name="'move.random'" object="$ShootTargets.{$ShootTargets.count}.pilot">
                    <param name="MaxDistance" value="5km"/>
                  </start_script>
                </do_if>
                <do_else>
                  <create_order object="$ShootTargets.{$ShootTargets.count}" id="'Wait'" immediate="true">
                    <param name="noattackresponse" value="true"/>
                  </create_order>
                </do_else>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShootingPrimary">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
              <do_if value="$PlayerWeaponsGroup.{$i}.macro == macro.weapon_gen_s_plasma_01_mk1_macro">
                <add_weapon_to_weapongroup weapon="$PlayerWeaponsGroup.{$i}" weapongroup="0" primary="true"/>
              </do_if>
            </do_all>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_SelectEnemy', $endline = 8005 ]" />
            <signal_cue cue="FlightSchool_Shooting_TargetHelper"/>
          </actions>
          <cues>
            <cue name="FlightSchool_ShootingPrimary_SelectClosestTarget">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="8004" comment="Just before saying 'Select the closest enemy target.'"/>
              </conditions>
              <actions>
                <do_if value="player.input.controller">
                  <show_help position="1" timeout="false" force="true" log="true" line="27005" comment="Press $INPUT_ACTION_TARGET_NEXT_ENEMY$ to target the closest enemy. This also locks the target."/>
                </do_if>
                <do_else>
                  <show_help position="1" timeout="false" force="true" log="true" line="27003" comment="Press $INPUT_ACTION_TARGET_NEXT_ENEMY$ to target the closest enemy."/>
                </do_else>
                <do_if value="player.target == $ShootTargets.{1}">
                  <signal_cue cue="FlightSchool_ShootingPrimary_ClosestTargetSelected" check="false"/>
                </do_if>
              </actions>
              <cues>
                <cue name="FlightSchool_ShootingPrimary_TargetChanged" instantiate="true">
                  <conditions>
                    <event_player_changed_target/>
                  </conditions>
                  <actions>
                    <sort_group group="$ShootTargets" sortbydistanceto="$PlayerShip"/>
                    <do_if value="event.param == $ShootTargets.{1}">
                      <signal_cue cue="FlightSchool_ShootingPrimary_ClosestTargetSelected" check="false"/>
                    </do_if>
                  </actions>
                </cue>

                <cue name="FlightSchool_ShootingPrimary_ClosestTargetSelected">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_CycleTargets', $endline = 8007 ]" />
                    <remove_help all="true"/>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ShootingPrimary_CycleTargets">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="8006" comment="Just before saying 'Slowly cycle through all the targets.'"/>
                      </conditions>
                      <actions>
                        <do_if value="player.input.controller">
                          <show_help position="1" timeout="false" force="true" log="true" line="27006" comment="Press $INPUT_ACTION_NEXT_TARGET_ACTION$ to cycle through targets."/>
                        </do_if>
                        <do_else>
                          <show_help position="1" timeout="false" force="true" log="true" line="27004" comment="Press $INPUT_ACTION_NEXT_TARGET_ACTION$ and $INPUT_ACTION_PREV_TARGET_ACTION$ to cycle through targets."/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_ShootingPrimary_SelectedTargetOutOfRange">
                          <conditions>
                            <event_player_changed_target/>
                            <check_value value="player.target and player.target.hasrelation.enemy.{$PlayerShip} and player.target.distanceto.{$PlayerShip} gt $PlayerShip.maxcombatrange.primary"/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <remove_help all="true"/>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_TargetOutOfRange', $endline = 8008 ]" />
                          </actions>
                          <cues>
                            <cue name="FlightSchool_ShootingPrimary_OutOfRangeUseCaseDone">
                              <conditions>
                                <event_speak_finished actor="$FlightInstructor" line="8008"/>
                              </conditions>
                              <actions>
                                <signal_cue cue="FlightSchool_ShootingPrimary_TargetPractice"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShootingPrimary_TargetPractice">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_DestroyTarget', $endline = 8009 ]" />
                <show_help position="1" timeout="false" force="true" log="true" line="27100" comment="Hold $INPUT_STATE_FIRE_PRIMARY_WEAPON$ to shoot your active primary weapons."/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" group="$ShootTargets" />
              </actions>
              <cues>
                <cue name="FlightSchool_ShootingPrimary_WeaponFired">
                  <conditions>
                    <event_weapon_fired group="$PlayerWeaponsGroup"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <do_if value="not player.input.controller and not player.input.joystick and not player.input.shootatcursor">
                      <show_help position="1" timeout="false" force="true" log="true" line="27101" comment="Hold either $INPUT_STATE_FIRE_PRIMARY_WEAPON_AT_CURSOR$ or both mouse buttons to shoot at the mouse cursor position."/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ShootingPrimary_WeaponFiredAtCursor">
                      <conditions>
                        <event_weapon_fired group="$PlayerWeaponsGroup"/>
                        <check_value value="player.input.shootatcursor"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_ShootingPrimary_TargetPractice_FirstTargetDestroyed">
                  <conditions>
                    <event_object_destroyed group="$ShootTargets"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_Heat', $endline = 8032 ]" />
                    <set_value name="$DestroyedTargets" exact="1"/>
                    <signal_cue cue="FlightSchool_Shooting_TargetHelper_MakeTargetsMove"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_ShootingPrimary_TargetPractice_Overheated">
                  <conditions>
                    <event_weapon_overheated group="$PlayerWeaponsGroup"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_Overheated', $endline = 8012 ]" />
                  </actions>
                </cue>

                <cue name="FlightSchool_ShootingPrimary_TargetPractice_TargetDestroyed" instantiate="true">
                  <conditions>
                    <event_object_destroyed group="$ShootTargets"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <set_value name="$DestroyedTargets" operation="add"/>
                    <do_if value="$DestroyedTargets gt 4">
                      <signal_cue cue="FlightSchool_ShootingPrimary_TargetPractice_Shielded"/>
                      <cancel_cue cue="this"/>
                    </do_if>
                    <do_else>
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" group="$ShootTargets" />
                    </do_else>
                  </actions>
                </cue>

                <cue name="FlightSchool_ShootingPrimary_TargetPractice_Shielded">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Shooting_ShieldedTarget', $endline = 8013 ]" />
                    <create_ship name="$ShieldedTarget" macro="$TargetPracticeShieldedMacro" sector="$PlayerShip.sector" capturable="false">
                      <owner exact="faction.ownerless" overridenpc="true" />
                      <pilot>
                        <select race="race.drone" tags="tag.aipilot"/>
                      </pilot>
                      <loadout ref="flightschool_shielded_training_target"/>
                      <safepos object="player.ship" z="1km"/>
                    </create_ship>
                    <set_relation_boost object="$ShieldedTarget" value="-1" faction="faction.player" silent="true"/>
                    <set_object_relation_behaviour object="$ShieldedTarget" disable="true"/>
                    <create_order object="$ShieldedTarget" id="'Wait'" immediate="true">
                      <param name="noattackresponse" value="true"/>
                    </create_order>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" object="$ShieldedTarget" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_ShootingPrimary_TargetPractice_Shielded_Destroyed">
                      <conditions>
                        <event_object_destroyed object="$ShieldedTarget"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="FlightSchool_ShootingPrimary_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShootingPrimary_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShootingPrimary"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ShootingSecondary">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Missile', $endline = 8014 ]" />
            <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
              <do_if value="$PlayerWeaponsGroup.{$i}.isclass.missilelauncher">
                <add_weapon_to_weapongroup weapon="$PlayerWeaponsGroup.{$i}" weapongroup="0" primary="false"/>
              </do_if>
            </do_all>
            <add_ammo object="$PlayerShip" macro="macro.missile_guided_light_mk1_macro" amount="10" comment="Just add as many as can fit"/>
            <!--destroy the shoot target that's furthest from the player; this indirectly spawns a new one in front of the player for the next part-->
            <sort_group group="$ShootTargets" sortbydistanceto="$PlayerShip" sortdescending="true"/>
            <destroy_object object="$ShootTargets.{1}"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" group="$ShootTargets"/>
          </actions>
          <cues>
            <cue name="FlightSchool_ShootingSecondary_TargetLocked">
              <conditions>
                <event_lock_initiated attacker="$PlayerShip"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Missile_Locking', $endline = 8015 ]" />
                <show_help position="1" timeout="false" force="true" log="true" line="27102" comment="Press $INPUT_STATE_FIRE_SECONDARY_WEAPON$ to fire a missile."/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShootingSecondary_MissileFired">
              <conditions>
                <event_player_launched_missile/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_help all="true"/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShootingSecondary_TargetDestroyed">
              <conditions>
                <event_object_destroyed group="$ShootTargets" method="killmethod.hitbymissile"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_CollectDrop', $endline = 8016 ]" />
                <spawn_drop object="event.object" drop="'drops_flightschool_guided_missile'"/>
                <find_object name="$Drop" class="class.collectable" space="event.object.zone"/>
                <set_object_min_hull object="$Drop" exact="1"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.collect" object="$Drop"/>
                <show_help position="1" timeout="false" force="true" log="true" line="14321" comment="Fly over an item or hold $INPUT_STATE_LOOTMAGNET$ to use the CONTAINER MAGNET to pick it up."/>
              </actions>
            </cue>

            <cue name="FlightSchool_ShootingSecondary_AmmoCollected">
              <conditions>
                <event_player_collected_ammo/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Missile_AmmoStorage', $endline = 8018 ]" />
                <remove_help all="true"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ShootingSecondary_AmmoStorageUseCaseFinished">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="8018"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_ShootingSecondary_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ShootingSecondary_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ShootingSecondary"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_ManageWeapons">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_WeaponManagement_OpenMenu', $endline = 8020 ]" />
            <show_help position="1" timeout="false" force="true" line="26900" comment="Press $INPUT_ACTION_OPEN_COCKPIT_MENU$ to open the SHIP MENU."/>
          </actions>
          <cues>
            <cue name="FlightSchool_ManageWeapons_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_help all="true"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_WeaponManagement_MenuOpened', $endline = 8026 ]" />
                <show_help position="4" timeout="false" force="true" log="true" line="27200" comment="Select the buttons on the grid to change a weapon's group assignments.\nSelect the dropdown to change the missile launcher's loaded ammunition."/>
                <show_help_overlay id="'docked_weaponconfig'" highlightonly="true"/>
              </actions>
              <cues>
                <cue name="FlightSchool_ManageWeapons_MenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <remove_help all="true"/>
                    <remove_help_overlay all="true"/>
                    <signal_cue cue="FlightSchool_ManageWeapons_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_ManageWeapons_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_ManageWeapons"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_CycleWeaponGroups">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_CycleWeaponGroups', $endline = 8028 ]" />
            <set_value name="$GroupsToActivate" exact="[0, 1, 2, 3]"/>
            <remove_from_list name="$GroupsToActivate" exact="$PlayerShip.activeweapongroup.primary"/>
          </actions>
          <cues>
            <cue name="FlightSchool_CycleWeaponGroups_ShowHint">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="8027" comment="Just before saying 'Please activate each primary group at least once.'"/>
              </conditions>
              <actions>
                <do_if value="player.input.controller or player.input.joystick">
                  <show_help position="1" timeout="false" force="true" log="true" line="27201" comment="Press $INPUT_ACTION_CYCLE_NEXT_PRIMARY_WEAPONGROUP$ to cycle your primary weapon group."/>
                </do_if>
                <do_else>
                  <show_help position="1" timeout="false" force="true" log="true" line="27202" comment="Press $INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_1$, $INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_2$, $INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_3$ and $INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_4$ to activate a primary weapon group."/>
                </do_else>
              </actions>
            </cue>

            <cue name="FlightSchool_CycleWeaponGroups_GroupActivated" instantiate="true">
              <conditions>
                <event_player_activated_weapongroup primary="true"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_from_list name="$GroupsToActivate" exact="event.param"/>
                <do_if value="not $GroupsToActivate.count">
                  <remove_help all="true"/>
                  <signal_cue cue="FlightSchool_CycleWeaponGroups_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="FlightSchool_CycleWeaponGroups_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_CycleWeaponGroups"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_CycleMissile">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="FlightSchool_CycleMissile_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_CycleMissile', $endline = 8029 ]" />
              <show_help position="1" timeout="false" force="true" log="true" line="27203" comment="Press $INPUT_ACTION_CYCLE_NEXT_ACTIVE_WEAPON_AMMO$ to cycle your active missile."/>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_CycleMissile_MissileCycled">
              <conditions>
                <event_player_cycled_active_weapon_ammo/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_MissileCycled', $endline = 8031 ]" />
              </actions>
              <cues>
                <cue name="FlightSchool_CycleMissile_UseCaseDone">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="8031"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_CycleMissile_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_CycleMissile_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_CycleMissile"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_RelativeMovement">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_ApproachShip', $endline = 9001 ]" />
            <create_ship name="$RelativeMovementShip" macro="macro.ship_arg_xl_resupplier_01_a_macro" sector="$PlayerShip.sector" capturable="false">
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_relative_movement_target"/>
              <owner exact="$AlliedFaction" overridenpc="true"/>
              <position z="50km" object="$PlayerShip"/>
            </create_ship>
            <set_object_relation_behaviour object="$RelativeMovementShip" disable="true"/>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$RelativeMovementShip"/>
          </actions>
          <cues>
            <cue name="FlightSchool_RelativeMovement_ApproachingShip" checkinterval="0.1s">
              <conditions>
                <check_value value="$RelativeMovementShip.distanceto.{$PlayerShip} lt 5km"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_GetCloseToSurface', $endline = 9002 ]" />
              </actions>
              <cues>
                <!-- wait for the current voice lines to finish before checking whether to say the "get closer" lines-->
                <cue name="FlightSchool_RelativeMovement_GetCloseToSurface_UseCaseFinished">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="9002"/>
                  </conditions>
                  <cues>
                    <cue name="FlightSchool_RelativeMovement_GetCloserCheck" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.input.flight.throttle == 0 and $PlayerShip.movementrefobject != $RelativeMovementShip"/>
                      </conditions>
                      <actions>
                        <do_if value="not $GetCloserHints?">
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_GetCloser_1', $endline = 9003 ]" />
                          <set_value name="$GetCloserHints" exact="1"/>
                          <set_value name="$GetCloserEndLine" exact="9003"/>
                        </do_if>
                        <do_elseif value="@$GetCloserHints == 1">
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_GetCloser_2', $endline = 9004 ]" />
                          <set_value name="$GetCloserHints" exact="2"/>
                          <set_value name="$GetCloserEndLine" exact="9004"/>
                        </do_elseif>
                        <do_else>
                          <!--this one can repeat indefinitely-->
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_GetCloser_3', $endline = 9005 ]" />
                          <set_value name="$GetCloserEndLine" exact="9005"/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_RelativeMovement_GetCloserCheck_ResetDelay">
                          <conditions>
                            <event_speak_finished actor="$FlightInstructor" line="$GetCloserEndLine"/>
                          </conditions>
                          <delay exact="2s"/>
                          <actions>
                            <reset_cue cue="FlightSchool_RelativeMovement_GetCloserCheck"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_RelativeMovement_Collided">
                  <conditions>
                    <event_object_collided group="$PlayerShipGroup" otherobject="$RelativeMovementShip"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_Collided', $endline = 9006 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_RelativeMovement_Collided_Timedout">
                      <delay exact="5s"/>
                      <actions>
                        <remove_from_list name="$QueuedUseCases" exact="table[ $name = '$FlightSchool_RelativeMovement_Collided', $endline = 9006 ]"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_RelativeMovement_CloseEnough" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$PlayerShip.movementrefobject == $RelativeMovementShip"/>
                  </conditions>
                  <actions>
                    <!--stop giving "get closer" hints even if the player leaves-->
                    <cancel_cue cue="FlightSchool_RelativeMovement_GetCloserCheck"/>
                    <do_if value="player.input.flight.throttle != 0">
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_CloseEnough', $endline = 9013 ]" />
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_RelativeMovement_Stopped" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.input.flight.throttle == 0"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_DestroyTargets', $endline = 9011 ]" />
                      </actions>
                      <cues>
                        <cue name="FlightSchool_RelativeMovement_SurfaceTargetsObjective">
                          <conditions>
                            <event_speak_finished actor="$FlightInstructor" line="9009"/>
                          </conditions>
                          <actions>
                            <set_relation_boost object="$RelativeMovementShip" value="-1" faction="faction.player" silent="true"/>
                            <add_to_group groupname="$SurfaceTargetsGroup" list="$RelativeMovementShip.turrets.operational.list"/>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" group="$SurfaceTargetsGroup"/>
                            <set_value name="$TargetCount" exact="$SurfaceTargetsGroup.count - 2"/>
                          </actions>
                          <cues>
                            <!--this cue shouldn't technically be necessary but it's here to make this part robust against stalling progress-->
                            <cue name="FlightSchool_RelativeMovement_AllSurfaceTargetsDestroyed_FallbackCheck" checkinterval="1s">
                              <conditions>
                                <check_value value="$RelativeMovementShip.turrets.operational.count == 0"/>
                              </conditions>
                              <actions>
                                <signal_cue cue="FlightSchool_RelativeMovement_EnoughSurfaceTargetsDestroyed"/>
                              </actions>
                            </cue>

                            <cue name="FlightSchool_RelativeMovement_EnoughSurfaceTargetsDestroyed">
                              <conditions>
                                <check_any>
                                  <check_all>
                                    <event_object_destroyed group="$SurfaceTargetsGroup"/>
                                    <check_value value="$SurfaceTargetsGroup.count le $TargetCount"/>
                                  </check_all>
                                  <event_cue_signalled/>
                                </check_any>
                              </conditions>
                              <actions>
                                <cancel_cue cue="FlightSchool_RelativeMovement_AllSurfaceTargetsDestroyed_FallbackCheck"/>
                                <reset_relation_boost object="$RelativeMovementShip" faction="faction.player"/>
                                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_RelativeMovement_Leave', $endline = 9012 ]" />
                                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1087}"/>
                              </actions>
                              <cues>
                                <cue name="FlightSchool_RelativeMovement_LeftShip" checkinterval="0.1s">
                                  <conditions>
                                    <check_value value="not $PlayerShip.movementrefobject"/>
                                  </conditions>
                                  <actions>
                                    <signal_cue cue="FlightSchool_RelativeMovement_Done"/>
                                  </actions>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_RelativeMovement_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_RelativeMovement"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_SpaceSuit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$PlayerShip.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 100m">
              <cancel_cue cue="FlightSchool_SpaceSuit_ArrivingAtWreck"/>
            </do_if>
            <do_else>
              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
              <do_if value="$PlayerShip.distanceto.{$SpaceSuitTutorialWreck} ge 50km">
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_TravelToWreck', $endline = 10001 ]" />
              </do_if>
            </do_else>
          </actions>
          <cues>
            <cue name="FlightSchool_SpaceSuit_ArrivingAtWreck" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.{$SpaceSuitTutorialWreck} lt 50km"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_ApproachWreck', $endline = 10003 ]" />
              </actions>
            </cue>

            <cue name="FlightSchool_SpaceSuit_NearWreck" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 250m"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_EnterSpaceSuit', $endline = 10004 ]" />
                <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit"/>
              </actions>
            </cue>

            <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <find_player_transporter_slot name="$TransporterSlot" object="$PlayerShip.controlroom"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.usespacesuit" slot="$TransporterSlot" comment="Use Spacesuit"/>
                <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_GetUpHint"/>
              </actions>
              <cues>
                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_StoppedControl" instantiate="true">
                  <conditions>
                    <event_player_stopped_control/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <remove_help all="true"/>
                    <remove_help_overlay id="'docked_getup'"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_StartedControl" instantiate="true">
                  <conditions>
                    <event_player_started_control/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_GetUpHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_OpenedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_MenuUsageHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_ClosedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_OpenedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_ConfirmHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_ClosedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <signal_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_GetUpHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <remove_help_overlay all="true"/>
                    <show_help position="1" timeout="false" force="true" log="true" line="27300" comment="Select GET UP via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                    <show_help_overlay id="'docked_getup'" highlightonly="true"/>
                    <set_value name="$GetUpHintActive" exact="true"/>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_SpaceSuit_GetUp_MoveHint" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'"/>
                      </conditions>
                      <actions>
                        <do_if value="$GetUpHintActive?">
                          <remove_help all="true"/>
                          <do_if value="event.param2 == ''">
                            <show_help position="4" timeout="false" force="true" line="27300" comment="Select GET UP via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_if>
                          <do_elseif value="event.param2 == 'menu_close'">
                            <show_help position="1" timeout="false" force="true" line="27300" comment="Select GET UP via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_elseif>
                        </do_if>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_TransporterMenuHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="0.5s"/>
                  <actions>
                    <remove_value name="$GetUpHintActive"/>
                    <remove_help all="true"/>
                    <do_if value="not player.input.controller">
                      <show_help position="1" log="true" line="27301" comment="You can also press $INPUT_ACTION_GET_UP$."/>
                    </do_if>
                    <do_if value="player.input.controller or player.input.joystick">
                      <show_help position="1" timeout="false" force="true" line="27302" comment="Press $INPUT_STATE_INTERACTION_MENU$ to interact with the button in the back of your ship."/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" line="27303" comment="Press $INPUT_STATE_INTERACTION_MENU$ or $INPUT_STATE_MOUSECLICK$ to interact with the button in the back of your ship."/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_TransporterMenuHint_Cancel">
                      <conditions>
                        <check_any>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                          <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                          <event_player_started_control/>
                        </check_any>
                      </conditions>
                      <actions>
                        <cancel_cue cue="parent"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_MenuUsageHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <show_help position="1" timeout="false" force="true" line="27304" comment="Select USE SPACESUIT, then confirm with $INPUT_STATE_WIDGET_SELECT$."/>
                  </actions>
                </cue>

                <cue name="FlightSchool_SpaceSuit_EnterSpaceSuit_ConfirmHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <show_help position="1" timeout="false" force="true" line="27305" comment="Press $INPUT_STATE_WIDGET_SELECT$ to confirm."/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_SpaceSuit_Basics">
              <conditions>
                <event_object_changed_room object="player.entity"/>
                <check_value value="player.ship.isclass.spacesuit"/>
              </conditions>
              <actions>
                <find_object_component groupname="$SpaceSuitRepairWeapons" object="player.ship" weapontype="repair" multiple="true"/>
                <find_object_component groupname="$SpaceSuitCombatWeapons" object="player.ship" weapontype="combat" multiple="true"/>
                <cancel_cue cue="FlightSchool_SpaceSuit_EnterSpaceSuit"/>
                <remove_help all="true"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_Undocked', $endline = 10012 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30179,3011}" comment="Adapt to Spacesuit"/>
              </actions>
              <cues>
                <cue name="FlightSchool_SpaceSuit_ExplanationFinished_Delay">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="10012"/>
                  </conditions>
                  <delay exact="3s"/>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_ComeToStop_Manual', $endline = 10007 ]" />
                    <do_if value="player.input.controller">
                      <show_help position="1" timeout="false" force="true" line="27400" comment="Try to come to a full stop using $INPUT_RANGE_STRAFE_LEFT_RIGHT$, $INPUT_RANGE_STRAFE_UP_DOWN$, $INPUT_RANGE_THROTTLE$, and $INPUT_STATE_FULLREVERSE$."/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" line="27401" comment="Try to come to a full stop using $INPUT_STATE_STRAFE_LEFT$, $INPUT_STATE_STRAFE_RIGHT$, $INPUT_STATE_STRAFE_UP$, $INPUT_STATE_STRAFE_DOWN$, $INPUT_STATE_ACCELERATE$, and $INPUT_STATE_DECELERATE$."/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_SpaceSuit_StopManual">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="10007"/>
                      </conditions>
                      <delay exact="10s"/>
                      <actions>
                        <remove_help all="true"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_ComeToStop_Assisted', $endline = 10008 ]" />
                        <do_if value="player.input.controller">
                          <show_help position="1" timeout="false" force="true" log="true" line="26432" comment="Hold $INPUT_RANGE_THROTTLE$ + $INPUT_STATE_FULLREVERSE$ to come to a full stop."/>
                        </do_if>
                        <do_else>
                          <show_help position="1" timeout="false" force="true" log="true" line="26419" comment="Press $INPUT_ACTION_STOP$ to come to a full stop."/>
                        </do_else>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_SpaceSuit_StopAssisted" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.occupiedship.speed == 0"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <signal_cue cue="FlightSchool_SpaceSuit_InsideWreck"/>
                        <cancel_cue cue="FlightSchool_SpaceSuit_ExplanationFinished_Delay"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_SpaceSuit_InsideWreck">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_FlyIntoWreck', $endline = 10009 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
              </actions>
              <cues>
                <cue name="FlightSchool_SpaceSuit_NearClosedEntry" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 10m"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <do_if value="$SpaceSuitTutorialEntryRepairPanel.hullpercentage lt 100">
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_NearWreckEntry', $endline = 10019 ]" />
                      <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.repair" object="$SpaceSuitTutorialEntryRepairPanel"/>
                      <signal_cue cue="FlightSchool_SpaceSuit_EntryPanel_WeaponCheck"/>
                    </do_if>
                    <do_else>
                      <signal_cue cue="FlightSchool_SpaceSuit_EntryPanelRepaired"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_SpaceSuit_EntryPanel_WeaponCheck">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <signal_cue cue="FlightSchool_SpaceSuit_EntryPanel_WeaponChanged"/>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_SpaceSuit_EntryPanel_WeaponChanged" instantiate="true">
                          <conditions>
                            <check_any>
                              <event_cue_signalled/>
                              <event_player_activated_weapongroup primary="true"/>
                            </check_any>
                          </conditions>
                          <actions>
                            <remove_value name="$RepairWeaponActive"/>
                            <do_for_each in="$SpaceSuitRepairWeapons">
                              <do_if value="loop.element.isreadytofire">
                                <set_value name="$RepairWeaponActive" exact="true"/>
                                <break/>
                              </do_if>
                            </do_for_each>
                            <remove_help all="true"/>
                            <do_if value="$RepairWeaponActive?">
                              <show_help position="1" timeout="false" force="true" line="27403" comment="Use your repair laser on the panel."/>
                            </do_if>
                            <do_else>
                              <show_help position="1" timeout="false" force="true" line="27402" comment="Switch to your repair laser."/>
                            </do_else>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="FlightSchool_SpaceSuit_EntryPanelRepaired">
                      <conditions>
                        <check_any>
                          <event_object_hull_repaired object="$SpaceSuitTutorialEntryRepairPanel"/>
                          <event_cue_signalled/>
                        </check_any>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_WreckEntryOpened', $endline = 10020 ]" />
                        <cancel_cue cue="FlightSchool_SpaceSuit_EntryPanel_WeaponChanged"/>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_SpaceSuit_EnterWreck" checkinterval="0.1s">
                          <conditions>
                            <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuit_EnterWreck_GuidancePositions.{1}] lt 5m"/>
                          </conditions>
                          <actions>
                            <do_if value="not $FlightSchool_SpaceSuit_InsideWreck_UseCaseTriggered?">
                              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_InsideWreck', $endline = 10014 ]" />
                              <set_value name="$FlightSchool_SpaceSuit_InsideWreck_UseCaseTriggered" exact="true"/>
                            </do_if>
                            <remove_from_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                            <do_if value="$SpaceSuit_EnterWreck_GuidancePositions.count">
                              <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                              <reset_cue cue="this"/>
                            </do_if>
                            <do_else>
                              <signal_cue cue="FlightSchool_SpaceSuit_WreckEntered"/>
                            </do_else>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_SpaceSuit_WreckEntered">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_RepairInteriorPanel', $endline = 10021 ]" />
                            <signal_cue cue="FlightSchool_SpaceSuit_LockboxPanel_WeaponCheck"/>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.repair" object="$SpaceSuitTutorialLockboxRepairPanel"/>
                          </actions>
                          <cues>
                            <cue name="FlightSchool_SpaceSuit_LockboxPanel_WeaponCheck">
                              <conditions>
                                <event_cue_signalled/>
                              </conditions>
                              <delay exact="1ms"/>
                              <actions>
                                <signal_cue cue="FlightSchool_SpaceSuit_LockboxPanel_WeaponChanged"/>
                              </actions>
                              <cues>
                                <cue name="FlightSchool_SpaceSuit_LockboxPanel_WeaponChanged" instantiate="true">
                                  <conditions>
                                    <check_any>
                                      <event_cue_signalled/>
                                      <event_player_activated_weapongroup primary="true"/>
                                    </check_any>
                                  </conditions>
                                  <actions>
                                    <remove_value name="$RepairWeaponActive"/>
                                    <do_for_each in="$SpaceSuitRepairWeapons">
                                      <do_if value="loop.element.isreadytofire">
                                        <set_value name="$RepairWeaponActive" exact="true"/>
                                        <break/>
                                      </do_if>
                                    </do_for_each>
                                    <remove_help all="true"/>
                                    <do_if value="$RepairWeaponActive?">
                                      <show_help position="1" timeout="false" force="true" line="27403" comment="Use your repair laser on the panel."/>
                                    </do_if>
                                    <do_else>
                                      <show_help position="1" timeout="false" force="true" line="27402" comment="Switch to your repair laser."/>
                                    </do_else>
                                  </actions>
                                </cue>
                              </cues>
                            </cue>

                            <cue name="FlightSchool_SpaceSuit_LockboxPanelRepaired">
                              <conditions>
                                <event_object_hull_repaired object="$SpaceSuitTutorialLockboxRepairPanel"/>
                              </conditions>
                              <delay exact="1ms"/>
                              <actions>
                                <remove_help all="true"/>
                                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_OpenLockbox', $endline = 10010 ]" />
                                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.destroy" group="$SpaceSuitTutorialLocks"/>
                                <signal_cue cue="FlightSchool_SpaceSuit_Lockbox_WeaponCheck"/>
                              </actions>
                              <cues>
                                <cue name="FlightSchool_SpaceSuit_Lockbox_WeaponCheck">
                                  <conditions>
                                    <event_cue_signalled/>
                                  </conditions>
                                  <delay exact="1ms"/>
                                  <actions>
                                    <signal_cue cue="FlightSchool_SpaceSuit_Lockbox_WeaponChanged"/>
                                  </actions>
                                  <cues>
                                    <cue name="FlightSchool_SpaceSuit_Lockbox_WeaponChanged" instantiate="true">
                                      <conditions>
                                        <check_any>
                                          <event_cue_signalled/>
                                          <event_player_activated_weapongroup primary="true"/>
                                        </check_any>
                                      </conditions>
                                      <actions>
                                        <remove_value name="$CombatWeaponActive"/>
                                        <do_for_each in="$SpaceSuitCombatWeapons">
                                          <do_if value="loop.element.isreadytofire">
                                            <set_value name="$CombatWeaponActive" exact="true"/>
                                            <break/>
                                          </do_if>
                                        </do_for_each>
                                        <remove_help all="true"/>
                                        <do_if value="$CombatWeaponActive?">
                                          <show_help position="1" timeout="false" force="true" line="27405" comment="Destroy the locks by shooting them."/>
                                        </do_if>
                                        <do_else>
                                          <show_help position="1" timeout="false" force="true" line="27404" comment="Switch to your hand laser."/>
                                        </do_else>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>

                                <cue name="FlightSchool_SpaceSuit_LockDamaged">
                                  <conditions>
                                    <event_object_hull_damaged group="$SpaceSuitTutorialLocks"/>
                                  </conditions>
                                  <actions>
                                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_LockDamaged', $endline = 10024 ]" />
                                  </actions>
                                </cue>

                                <cue name="FlightSchool_SpaceSuit_LockboxOpened">
                                  <conditions>
                                    <event_lockbox_opened object="$SpaceSuitTutorialLockbox"/>
                                  </conditions>
                                  <actions>
                                    <remove_help all="true"/>
                                    <show_help position="1" timeout="false" force="true" line="14321" comment="Fly over an item or hold $INPUT_STATE_LOOTMAGNET$ to use the CONTAINER MAGNET to pick it up."/>
                                    <signal_cue cue="FlightSchool_SpaceSuit_ReturnToShip"/>
                                    <find_object name="$Drop" class="class.collectable" space="player.zone"/>
                                    <set_object_velocity object="$Drop">
                                      <linear x="0" y="0" z="0"/>
                                    </set_object_velocity>
                                  </actions>
                                  <cues>
                                    <cue name="FlightSchool_SpaceSuit_WareCollected">
                                      <conditions>
                                        <event_player_collected_ware/>
                                      </conditions>
                                      <delay exact="1ms"/>
                                      <actions>
                                        <remove_help all="true"/>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_SpaceSuit_ReturnToShip">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1026}" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_LeaveWreckAndReturn', $endline = 10013 ]" />
              </actions>
              <cues>
                <cue name="FlightSchool_SpaceSuit_WreckLeft" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 10m"/>
                  </conditions>
                  <actions>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.dockat" object="$PlayerShip"/>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_Booster', $endline = 10015 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_SpaceSuit_ApproachingShip" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.occupiedship.distanceto.{$PlayerShip} lt 50m"/>
                      </conditions>
                      <actions>
                        <do_if value="player.occupiedship != $PlayerShip and not player.occupiedship.assigneddock?">
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_RequestDock', $endline = 10016 ]" />
                          <do_if value="player.input.controller">
                            <show_help position="1" timeout="false" force="true" log="true" line="27500" comment="To request docking permission, select your ship and open the INTERACT MENU ($INPUT_STATE_INTERACTION_MENU$)."/>
                          </do_if>
                          <do_else>
                            <show_help position="1" timeout="false" force="true" log="true" line="27501" comment="To request docking permission, select your ship and open the INTERACT MENU ($INPUT_STATE_INTERACTION_MENU$ or right click)."/>
                          </do_else>
                          <!--<show_help_overlay id="'docked_undock'" highlightonly="true"/>-->
                        </do_if>
                        <do_else>
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AlreadyFamiliar', $endlines = [10, 11] ]" />
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_SpaceSuit_DockingGranted">
                          <conditions>
                            <event_object_dock_assigned object="player.occupiedship"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <show_help position="1" timeout="false" force="true" log="true" line="27502" comment="Follow the lights to the dock."/>
                            <!--<remove_help_overlay id="'docked_undock'"/>-->
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_SpaceSuit_Dock', $endline = 10017 ]" />
                          </actions>
                        </cue>

                        <cue name="FlightSchool_SpaceSuit_ReturnedToShip">
                          <conditions>
                            <event_object_changed_room object="player.entity"/>
                            <check_value value="not player.ship.isclass.spacesuit"/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <remove_help all="true"/>
                            <show_help position="1" timeout="false" force="true" line="1040" comment="To sit down in your chair"/>
                            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.embark" object="$PlayerShip"/>
                          </actions>
                          <cues>
                            <cue name="FlightSchool_SpaceSuit_StartedShipcontrol">
                              <conditions>
                                <event_player_started_control/>
                                <check_value value="player.controlled == $PlayerShip"/>
                              </conditions>
                              <actions>
                                <remove_help all="true"/>
                                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
                                <signal_cue cue="FlightSchool_SpaceSuit_Done"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_SpaceSuit_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_SpaceSuit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_FlightAssist">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Newtonian_Activate', $endline = 11002 ]" />
          </actions>
          <cues>
            <cue name="FlightSchool_FlightAssist_TurnOffObjectiveandHint">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="11001"/>
              </conditions>
              <actions>
                <do_if value="player.input.controller">
                  <show_help position="1" timeout="false" force="true" log="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                  <set_value name="$FlightAssistHintActive" exact="true"/>
                </do_if>
                <do_else>
                  <show_help position="1" timeout="false" force="true" log="true" line="27601" comment="Press $INPUT_ACTION_TOGGLE_FLIGHT_ASSIST$ to turn off FLIGHT ASSIST."/>
                </do_else>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1093}"/>
              </actions>
              <cues>
                <cue name="FlightSchool_FlightAssist_MoveHint" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'DockedMenu'"/>
                  </conditions>
                  <actions>
                    <do_if value="$FlightAssistHintActive?">
                      <remove_help all="true"/>
                      <do_if value="event.param2 == ''">
                        <show_help position="4" timeout="false" force="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                      </do_if>
                      <do_elseif value="event.param2 == 'menu_close'">
                        <show_help position="1" timeout="false" force="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                      </do_elseif>
                    </do_if>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FlightAssist_TurnedOff" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.flightassist"/>
              </conditions>
              <actions>
                <!--TODO: interrupt usecase if it's still going and say line 10 or 11?-->
                <remove_help all="true"/>
                <remove_value name="$FlightAssistHintActive"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Newtonian_TryOut', $endline = 11003 ]" />
                <cancel_cue cue="FlightSchool_FlightAssist_TurnOffObjectiveandHint"/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
              </actions>
              <cues>
                <cue name="FlightSchool_FlightAssist_TurnOnHint">
                  <delay exact="10s"/>
                  <actions>
                    <do_if value="player.input.controller">
                      <show_help position="1" timeout="false" force="true" log="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                      <set_value name="$FlightAssistHintActive" exact="true"/>
                    </do_if>
                    <do_else>
                      <show_help position="1" timeout="false" force="true" log="true" line="27603" comment="Press $INPUT_ACTION_TOGGLE_FLIGHT_ASSIST$ to turn FLIGHT ASSIST back on."/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_FlightAssist_TurnOn_MoveHint" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'"/>
                      </conditions>
                      <actions>
                        <do_if value="$FlightAssistHintActive?">
                          <remove_help all="true"/>
                          <do_if value="event.param2 == ''">
                            <show_help position="4" timeout="false" force="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_if>
                          <do_elseif value="event.param2 == 'menu_close'">
                            <show_help position="1" timeout="false" force="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          </do_elseif>
                        </do_if>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_FlightAssist_TurnedOn" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.flightassist"/>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <remove_value name="$FlightAssistHintActive"/>
                    <cancel_cue cue="FlightSchool_FlightAssist_TurnOnHint"/>
                    <signal_cue cue="FlightSchool_FlightAssist_Travel"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FlightAssist_Travel">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_NewtonianTravel_ActivateMode', $endline = 11005 ]" />
              </actions>
              <cues>
                <cue name="FlightSchool_FlightAssist_Travel_ActivateModeObjectiveAndHint">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="11005"/>
                  </conditions>
                  <actions>
                    <show_help position="1" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU \($INPUT_ACTION_OPEN_COCKPIT_MENU$\)."/>
                    <set_value name="$TravelModeHintActive" exact="true"/>
                    <show_help_overlay id="'docked_modes'" highlightonly="true"/>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1090}"/>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_FlightAssist_Travel_MoveHint" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'"/>
                      </conditions>
                      <actions>
                        <do_if value="$TravelModeHintActive?">
                          <remove_help all="true"/>
                          <do_if value="event.param2 == ''">
                            <show_help position="4" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU \($INPUT_ACTION_OPEN_COCKPIT_MENU$\)."/>
                          </do_if>
                          <do_elseif value="event.param2 == 'menu_close'">
                            <show_help position="1" timeout="false" force="true" line="4314" comment="To activate TRAVEL MODE, select it via the SHIP MENU \($INPUT_ACTION_OPEN_COCKPIT_MENU$\)."/>
                          </do_elseif>
                        </do_if>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_FlightAssist_Travel_ModeActivated">
                  <conditions>
                    <check_any>
                      <event_player_travelmode_charge_started/>
                      <event_player_travelmode_started/>
                    </check_any>
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <remove_help_overlay id="'docked_modes'"/>
                    <do_if value="$ShipMenuOpen?">
                      <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                    </do_if>
                    <cancel_cue cue="FlightSchool_FlightAssist_Travel_ActivateModeObjectiveAndHint"/>
                    <remove_value name="$TravelModeHintActive"/>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_FlightAssist_Travel_MenuClosed">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_FlightAssist_Travel_Started">
                  <conditions>
                    <event_player_travelmode_started/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_NewtonianTravel_ModeActivated', $endline = 11006 ]" />
                    <set_value name="$TargetSpeed" exact="$PlayerShip.travel.maxspeed * 0.33"/>
                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1076}">
                      <progress progress="0" max="100"/>
                    </set_objective>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_FlightAssist_Travel_GainSpeedObjective">
                      <delay exact="1ms"/>
                      <actions>
                        <update_objective_progress cue="X4ep1_Gamestart_FlightSchool" progress="1000 * $PlayerShip.speed / $TargetSpeed" max="1000"/>
                        <reset_cue cue="this"/>
                      </actions>
                    </cue>

                    <cue name="FlightSchool_FlightAssist_Travel_SpeedGained" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$PlayerShip.speed gt $TargetSpeed"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_NewtonianTravel_TurnOffFlightAssist', $endline = 11007 ]" />
                        <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1093}"/>
                        <cancel_cue cue="FlightSchool_FlightAssist_Travel_MenuClosed"/>
                        <do_if value="player.input.controller">
                          <show_help position="1" timeout="false" force="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                          <set_value name="$FlightAssistHintActive" exact="true"/>
                        </do_if>
                        <do_else>
                          <show_help position="1" timeout="false" force="true" line="27601" comment="Press $INPUT_ACTION_TOGGLE_FLIGHT_ASSIST$ to turn off FLIGHT ASSIST."/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_FlightAssistOff_Travel_MoveHint" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'"/>
                          </conditions>
                          <actions>
                            <do_if value="$FlightAssistHintActive?">
                              <remove_help all="true"/>
                              <do_if value="event.param2 == ''">
                                <show_help position="4" timeout="false" force="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                              </do_if>
                              <do_elseif value="event.param2 == 'menu_close'">
                                <show_help position="1" timeout="false" force="true" line="27604" comment="To deactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                              </do_elseif>
                            </do_if>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_FlightAssist_Travel_AssistOff" checkinterval="0.1s">
                          <conditions>
                            <check_value value="not player.flightassist"/>
                          </conditions>
                          <actions>
                            <create_object name="$FlyToBeacon" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                              <position object="$PlayerShip" x="10000km"/>
                            </create_object>
                            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_NewtonianTravel_AlignAndActivateFlightAssist', $endline = 11011 ]" />
                            <remove_help all="true"/>
                            <remove_value name="$FlightAssistHintActive"/>
                          </actions>
                          <cues>
                            <cue name="FlightSchool_FlightAssist_Travel_AlignObjective">
                              <conditions>
                                <event_speak_finished actor="$FlightInstructor" line="11010"/>
                              </conditions>
                              <actions>
                                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1089}" object="$FlyToBeacon"/>
                              </actions>
                              <cues>
                                <cue name="FlightSchool_FlightAssist_Travel_Aligned" checkinterval="0.1s">
                                  <conditions>
                                    <check_value value="@$FlyToBeacon.exists"/>
                                    <check_object object="$FlyToBeacon">
                                      <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg"/>
                                    </check_object>
                                  </conditions>
                                  <actions>
                                    <do_if value="player.input.controller">
                                      <show_help position="1" timeout="false" force="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                      <set_value name="$FlightAssistHintActive" exact="true"/>
                                    </do_if>
                                    <do_else>
                                      <show_help position="1" timeout="false" force="true" line="27603" comment="Press $INPUT_ACTION_TOGGLE_FLIGHT_ASSIST$ to turn FLIGHT ASSIST back on."/>
                                    </do_else>
                                    <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1094}"/>
                                  </actions>
                                  <cues>
                                    <cue name="FlightSchool_FlightAssist_Travel_TurnOn_MoveHint" instantiate="true">
                                      <conditions>
                                        <event_ui_triggered screen="'DockedMenu'"/>
                                      </conditions>
                                      <actions>
                                        <do_if value="$FlightAssistHintActive?">
                                          <remove_help all="true"/>
                                          <do_if value="event.param2 == ''">
                                            <show_help position="4" timeout="false" force="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                          </do_if>
                                          <do_elseif value="event.param2 == 'menu_close'">
                                            <show_help position="1" timeout="false" force="true" line="27605" comment="To reactivate FLIGHT ASSIST, select it via the SHIP MENU ($INPUT_ACTION_OPEN_COCKPIT_MENU$)."/>
                                          </do_elseif>
                                        </do_if>
                                      </actions>
                                    </cue>

                                    <cue name="FlightSchool_FlightAssist_Travel_AssistOn" checkinterval="0.1s">
                                      <conditions>
                                        <check_value value="player.flightassist"/>
                                      </conditions>
                                      <actions>
                                        <remove_help all="true"/>
                                        <remove_value name="$FlightAssistHintActive"/>
                                        <signal_cue cue="FlightSchool_FlightAssist_Finish"/>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FlightAssist_Finish">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_NewtonianTravel_Done', $endline = 11013 ]" />
              </actions>
              <cues>
                <cue name="FlightSchool_FlightAssist_Finish_SpeakFinished">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="11013"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="FlightSchool_FlightAssist_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_FlightAssist_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_FlightAssist"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Docking">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.dockat" object="$Station"/>
            <do_if value="$PlayerShip.distanceto.{$Station} gt 5km">
              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_FlyToStation', $endline = 12001 ]" />
            </do_if>
          </actions>
          <cues>
            <cue name="FlightSchool_Docking_NearStation" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.{$Station} lt 5km"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_RequestDock', $endline = 12002 ]" />
              </actions>
            </cue>

            <cue name="FlightSchool_Docking_DockAssigned">
              <conditions>
                <event_object_dock_assigned group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_FlyToDock', $endline = 12003 ]" />
                <set_value name="$MaxOffsetRot" exact="$PlayerShip.assigneddock.maxoffset.{$PlayerShip.docksize}.rotation" />
                <set_value name="$MaxOffsetPos" exact="$PlayerShip.assigneddock.maxoffset.{$PlayerShip.docksize}.position" />
                <set_value name="$DockTargetPos" exact="$PlayerShip.assigneddock.dockslot.relativeposition.{$PlayerShip.assigneddock}"/>
                <set_value name="$DockTargetRot" exact="$PlayerShip.assigneddock.dockslot.relativerotation.{$PlayerShip.assigneddock}"/>
                <set_value name="$ViewDirectionHintAngle" exact="30deg"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Docking_FlyToDock_SpeakFinished">
                  <conditions>
                    <event_speak_finished actor="$FlightInstructor" line="12003"/>
                  </conditions>
                  <actions>
                    <set_value name="$FlyToDockSpeakFinished" exact="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Docking_Helper" checkinterval="0.1s">
              <conditions>
                <check_value value="player.isdockuiactive and $FlyToDockSpeakFinished?"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue cue="FlightSchool_Docking_Check"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Docking_Check" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <!--check orientation first-->
                    <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                    <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                    <set_value name="$DeltaRoll" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.roll - $DockTargetRot.roll" />
                    <do_if value="$DeltaYaw lt -$ViewDirectionHintAngle or $DeltaYaw gt $ViewDirectionHintAngle or $DeltaPitch lt -$ViewDirectionHintAngle or $DeltaPitch gt $ViewDirectionHintAngle">
                      <signal_cue cue="FlightSchool_Docking_ViewDirection"/>
                    </do_if>
                    <do_elseif value="not $Align_General_UseCase_Triggered?">
                      <set_value name="$Align_General_UseCase_Triggered" exact="true"/>
                      <signal_cue cue="FlightSchool_Docking_Align_General_UseCase"/>
                    </do_elseif>
                    <do_elseif value="$DeltaYaw lt -$MaxOffsetRot.yaw or $DeltaYaw gt $MaxOffsetRot.yaw or $DeltaPitch lt -$MaxOffsetRot.pitch or $DeltaPitch gt $MaxOffsetRot.pitch">
                      <signal_cue cue="FlightSchool_Docking_YawAndPitch"/>
                    </do_elseif>
                    <do_elseif value="$DeltaRoll lt -$MaxOffsetRot.roll or $DeltaRoll gt $MaxOffsetRot.roll">
                      <signal_cue cue="FlightSchool_Docking_Roll"/>
                    </do_elseif>
                    <do_elseif value="not $Rotation_OK_UseCases_Triggered?">
                      <set_value name="$Rotation_OK_UseCases_Triggered" exact="true"/>
                      <signal_cue cue="FlightSchool_Docking_Rotation_OK_UseCases"/>
                    </do_elseif>
                    <do_else>
                      <!--check x and z positions-->
                      <set_value name="$DeltaX" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.x - $DockTargetPos.x" />
                      <set_value name="$DeltaZ" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.z - $DockTargetPos.z" />
                      <do_if value="$DeltaZ lt -$MaxOffsetPos.z or $DeltaZ gt $MaxOffsetPos.z">
                        <signal_cue cue="FlightSchool_Docking_Z"/>
                      </do_if>
                      <do_elseif value="$DeltaX lt -$MaxOffsetPos.x or $DeltaX gt $MaxOffsetPos.x">
                        <signal_cue cue="FlightSchool_Docking_X"/>
                      </do_elseif>
                      <do_else>
                        <!--all aligned, touch down-->
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TouchDown', $endline = 12018 ]" />
                      </do_else>
                    </do_else>
                  </actions>
                </cue>

                <cue name="FlightSchool_Docking_ViewDirection" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TurnShipAround', $endline = 12004 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_ViewDirection_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12004"/>
                      </conditions>
                      <cues>
                        <cue name="FlightSchool_Docking_ViewDirection_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                            <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                            <check_value value="$DeltaYaw gt -$ViewDirectionHintAngle and $DeltaYaw lt $ViewDirectionHintAngle and $DeltaPitch gt -$ViewDirectionHintAngle and $DeltaPitch lt $ViewDirectionHintAngle"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="FlightSchool_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_Align_General_UseCase">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_Align_General', $endline = 12007 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_Align_General_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12007"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="FlightSchool_Docking_Check"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_YawAndPitch" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_AlignYawAndPitch', $endline = 12008 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_YawAndPitch_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12008"/>
                      </conditions>
                      <cues>
                        <cue name="FlightSchool_Docking_YawAndPitch_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                            <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                            <check_value value="$DeltaYaw gt -$MaxOffsetRot.yaw and $DeltaYaw lt $MaxOffsetRot.yaw and $DeltaPitch gt -$MaxOffsetRot.pitch and $DeltaPitch lt $MaxOffsetRot.pitch"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="FlightSchool_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_Roll" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_AlignRoll', $endline = 12009 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_Roll_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12009"/>
                      </conditions>
                      <cues>
                        <cue name="FlightSchool_Docking_Roll_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaRoll" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.roll - $DockTargetRot.roll" />
                            <check_value value="$DeltaRoll gt -$MaxOffsetRot.roll and $DeltaRoll lt $MaxOffsetRot.roll"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="FlightSchool_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_Rotation_OK_UseCases">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_RotationAligned', $endline = 12010 ]" />
                    <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_ShipPositionMarker', $endline = 12012 ]" />
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_Rotation_OK_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12012"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="FlightSchool_Docking_Check"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_Z" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <do_if value="$DeltaZ lt 0">
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TooFarBack', $endline = 12015 ]" />
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TooFarAhead', $endline = 12015 ]" />
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_Z_SpeakFinished">
                      <conditions>
                        <event_speak_finished actor="$FlightInstructor" line="12015"/>
                      </conditions>
                      <cues>
                        <cue name="FlightSchool_Docking_Z_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaZ" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.z - $DockTargetPos.z" />
                            <check_value value="$DeltaZ gt -$MaxOffsetPos.z and $DeltaZ lt $MaxOffsetPos.z"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="FlightSchool_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_X" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <do_if value="$DeltaX lt 0">
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TooFarLeft', $endline = 12016 ]" />
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_TooFarRight', $endline = 12017 ]" />
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_X_SpeakFinished">
                      <conditions>
                        <check_any>
                          <event_speak_finished actor="$FlightInstructor" line="12016"/>
                          <event_speak_finished actor="$FlightInstructor" line="12017"/>
                        </check_any>
                      </conditions>
                      <cues>
                        <cue name="FlightSchool_Docking_X_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaX" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.x - $DockTargetPos.x" />
                            <check_value value="$DeltaX gt -$MaxOffsetPos.x and $DeltaX lt $MaxOffsetPos.x"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="FlightSchool_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Docking_Docked">
              <conditions>
                <event_object_docked group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <cancel_cue cue="FlightSchool_Docking_Helper"/>
                <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Docking_Started', $endline = 12019 ]" />
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
              </actions>
              <cues>
                <cue name="FlightSchool_Docking_DockedMenu_Opened">
                  <conditions>
                    <event_ui_triggered screen="'DockedMenu'"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <set_value name="$PendingUseCases" exact="[ table[ $name = '$FlightSchool_DockedMenu_ShipInfo', $endline = 13002, $highlight = 'docked_shipinfo' ],
                                                                table[ $name = '$FlightSchool_DockedMenu_Trade', $endline = 13007, $highlight = 'docked_trade' ],
                                                                table[ $name = '$FlightSchool_DockedMenu_Upgrade', $endline = 13009, $highlight = 'docked_upgrade_repair' ],
                                                                table[ $name = '$FlightSchool_DockedMenu_Undock', $endline = 13012, $highlight = 'docked_undock' ],
                                                              ]"/>
                    <signal_cue cue="FlightSchool_Docking_DockedMenu_UseCaseHelper"/>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_Docking_DockedMenu_UseCaseHelper" instantiate="true">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <do_if value="$PendingUseCases.count">
                          <signal_cue_instantly cue="QueueInstructorUseCase" param="$PendingUseCases.{1}" />
                          <!--the entry will be removed from the list if and when the player opens the corresponding menu-->
                        </do_if>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_Docking_DockedMenu_SpeakFinished">
                          <conditions>
                            <event_speak_finished actor="$FlightInstructor" line="$PendingUseCases.{1}.$endline"/>
                          </conditions>
                          <actions>
                            <show_help_overlay id="$PendingUseCases.{1}.$highlight" highlightonly="true"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="FlightSchool_Docking_ShipInfoMenu_Opened">
                      <conditions>
                        <event_ui_triggered screen="'MapMenu'" control="'info'"/>
                      </conditions>
                      <actions>
                        <remove_help_overlay all="true"/>
                        <remove_from_list name="$PendingUseCases" exact="table[ $name = '$FlightSchool_DockedMenu_ShipInfo', $endline = 13002, $highlight = 'docked_shipinfo' ]"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_DockedMenu_ShipInfo_Opened', $endline = 13006 ]" />
                      </actions>
                      <cues>
                        <cue name="FlightSchool_Docking_ShipInfoMenu_CloseHint">
                          <conditions>
                            <event_speak_finished actor="$FlightInstructor" line="13006"/>
                          </conditions>
                          <actions>
                            <show_help position="4" timeout="false" force="true" line="26903" comment="Press $INPUT_ACTION_WIDGET_BACK$ to close menus."/>
                          </actions>
                        </cue>

                        <cue name="FlightSchool_Docking_ShipInfoMenu_Closed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <cancel_cue cue="FlightSchool_Docking_ShipInfoMenu_CloseHint"/>
                            <signal_cue cue="FlightSchool_Docking_DockedMenu_UseCaseHelper"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="FlightSchool_Docking_TradeMenu_Opened">
                      <conditions>
                        <event_ui_triggered screen="'MapMenu'" control="''"/>
                        <check_value value="event.param3.{6} == 'tradecontext'"/>
                      </conditions>
                      <actions>
                        <remove_help_overlay all="true"/>
                        <remove_from_list name="$PendingUseCases" exact="table[ $name = '$FlightSchool_DockedMenu_Trade', $endline = 13007, $highlight = 'docked_trade' ]"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_DockedMenu_Trade_Opened', $endline = 13008 ]" />
                        <show_help position="4" timeout="false" force="true" log="true" line="27700" comment="Press $INPUT_ACTION_WIDGET_SCROLL_UP$ and $INPUT_ACTION_WIDGET_SCROLL_DOWN$ to change the selected ware.\n\nPress $INPUT_ACTION_ADDON_DETAILMONITOR_LEFT$ and $INPUT_ACTION_ADDON_DETAILMONITOR_RIGHT$ to change the traded amount.\n\nSelect CONFIRM to execute the trade."/>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_Docking_TradeMenu_Closed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <signal_cue cue="FlightSchool_Docking_DockedMenu_UseCaseHelper"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="FlightSchool_Docking_UpgradeMenu_Opened">
                      <conditions>
                        <event_ui_triggered screen="'ShipConfigurationMenu'"/>
                      </conditions>
                      <actions>
                        <remove_help_overlay all="true"/>
                        <remove_from_list name="$PendingUseCases" exact="table[ $name = '$FlightSchool_DockedMenu_Upgrade', $endline = 13009, $highlight = 'docked_upgrade_repair' ]"/>
                        <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_DockedMenu_Upgrade_Opened', $endline = 13010 ]" />
                        <show_help position="1" timeout="false" force="true" log="true" line="27701" comment="The available equipment is on the left side, sorted into categories. Select one and press $INPUT_STATE_WIDGET_SELECT$ to add it to your loadout. When you're done select ADD TO SHOPPING LIST on the right, then CONFIRM ORDER in the bottom right."/>
                      </actions>
                      <cues>
                        <cue name="FlightSchool_Docking_UpgradeMenu_Closed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'"/>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <do_if value="$PlayerShip.build">
                              <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_DockedMenu_UpgradesBought', $endline = 13015 ]" />
                            </do_if>
                            <signal_cue cue="FlightSchool_Docking_DockedMenu_UseCaseHelper"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="FlightSchool_Docking_Undocked">
                  <conditions>
                    <event_object_undocked group="$PlayerShipGroup"/>
                  </conditions>
                  <actions>
                    <remove_help_overlay all="true"/>
                    <signal_cue cue="FlightSchool_Docking_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_Docking_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_Docking"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_AdaptiveSteering">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_AdaptiveSteering', $endline = 14007 ]" />
          </actions>
          <cues>
            <cue name="FlightSchool_AdaptiveSteering_SpeakFinished">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="14005" comment="just before saying line 14006: 'I've turned on adaptive steering and changed the thruster configuration of your ship to favour roll over yaw.'"/>
              </conditions>
              <actions>
                <generate_loadout macro="$PlayerShipMacro" macros="[macro.thruster_gen_s_combat_01_mk1_macro]" result="$Loadouts" flags="thrusters"/>
                <apply_loadout object="$PlayerShip" flags="thrusters" loadout="$Loadouts.{1}"/>
                <set_adaptive_steering_forced/>
                <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.custom" customaction="{30178,1095}" endtime="player.age + 1min"/>
              </actions>
              <cues>
                <cue name="FlightSchool_AdaptiveSteering_Timeout">
                  <delay exact="1min"/>
                  <actions>
                    <reset_adaptive_steering/>
                    <signal_cue cue="FlightSchool_AdaptiveSteering_Done"/>
                    <do_if value="player.input.controller or player.input.joystick">
                      <do_if value="player.input.adaptivesticksteering">
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1114}, [ 'adaptivesticksteering_on', {30178,1121}, false ], [ 'adaptivesticksteering_off', {30178,1122} ], 'stick_steering_adaptive', 'right' ]]"/>
                      </do_if>
                      <do_else>
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1115}, [ 'adaptivesticksteering_on', {30178,1120}, true ], [ 'adaptivesticksteering_off', {30178,1122} ], 'stick_steering_adaptive', 'right' ]]"/>
                      </do_else>
                    </do_if>
                    <do_else>
                      <do_if value="player.input.adaptivemousesteering">
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1116}, [ 'adaptivemousesteering_on', {30178,1121}, false ], [ 'adaptivemousesteering_off', {30178,1122} ], 'mouse_steering_adaptive', 'right' ]]"/>
                      </do_if>
                      <do_else>
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1117}, [ 'adaptivemousesteering_on', {30178,1120}, true ], [ 'adaptivemousesteering_off', {30178,1122} ], 'mouse_steering_adaptive', 'right' ]]"/>
                      </do_else>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="FlightSchool_AdaptiveSteering_QuestionAnsweredOrClosed">
                      <conditions>
                        <check_any>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                        </check_any>
                      </conditions>
                      <actions>
                        <signal_cue cue="FlightSchool_AdaptiveSteering_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="FlightSchool_AdaptiveSteering_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="FlightSchool_TriggerNext"/>
                <cancel_cue cue="FlightSchool_AdaptiveSteering"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="FlightSchool_Complete">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_objective cue="X4ep1_Gamestart_FlightSchool" action="objective.none"/>
            <unlock_achievement name="FLIGHT_SCHOOL" scenario="true" />
            <signal_cue_instantly cue="QueueInstructorUseCase" param="table[ $name = '$FlightSchool_Conclusion', $endline = 15002 ]" />
            <add_research ware="ware.research_teleportation"/>
            <add_research ware="ware.research_teleportation_range_01"/>
            <add_research ware="ware.research_teleportation_range_02"/>
            <add_research ware="ware.research_teleportation_range_03"/>
            <!--S-sized ships-->
            <set_value name="$ShipSpawnX" exact="0m"/>
            <create_ship name="$AdditionalShip" macro="macro.ship_arg_s_fighter_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_s_fighter_01" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>
            <create_ship name="$AdditionalShip" macro="macro.ship_arg_s_fighter_02_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_s_fighter_02" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>
            <!--<create_ship name="$AdditionalShip" macro="macro.ship_arg_s_heavyfighter_02_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_s_heavyfighter" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>-->
            <!--<create_ship name="$AdditionalShip" macro="macro.ship_arg_s_scout_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_s_scout" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>-->
            <create_ship name="$AdditionalShip" macro="macro.ship_arg_s_trans_container_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_s_transporter" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>
            <!--M-sized ships-->
            <create_ship name="$AdditionalShip" macro="macro.ship_arg_m_frigate_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_m_frigate" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>
            <!--<create_ship name="$AdditionalShip" macro="macro.ship_arg_m_bomber_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_m_bomber" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>-->
            <create_ship name="$AdditionalShip" macro="macro.ship_arg_m_miner_solid_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_m_miner" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>
            <set_value name="$ShipSpawnX" exact="200m" operation="add"/>
            <!--<create_ship name="$AdditionalShip" macro="macro.ship_arg_m_trans_container_01_a_macro" sector="$Station.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true" />
              <loadout ref="flightschool_m_transporter" />
              <safepos x="$ShipSpawnX" z="10km" object="$Station" space="$Station.sector" allowyaxis="false"/>
            </create_ship>
            <add_to_group groupname="$PlayerShipGroup" object="$AdditionalShip"/>
            <set_object_sellable object="$AdditionalShip" sellable="false"/>-->
          </actions>
          <cues>
            <cue name="FlightSchool_Complete_SpeakFinished">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="15001"/>
              </conditions>
              <actions>
                <show_help position="1" timeout="false" force="true" log="true" line="27702" comment="To teleport, select the target ship and open the INTERACT MENU ($INPUT_STATE_INTERACTION_MENU$)."/>
              </actions>
            </cue>

            <cue name="FlightSchool_Complete_Teleported">
              <conditions>
                <event_player_teleport_successful/>
              </conditions>
              <actions>
                <remove_help all="true"/>
                <cancel_cue cue="FlightSchool_Complete_SpeakFinished"/>
              </actions>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
  </cues>
</mdscript>