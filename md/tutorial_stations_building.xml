<?xml version="1.0" encoding="utf-8"?>
<mdscript name="Tutorial_stations_building" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
  <cues>
    <cue name="Start" namespace="this">
      <conditions>
        <event_cue_signalled cue="md.Setup.Start" />
      </conditions>
      <actions>
        <do_if value="not md.$TutorialRegister?">
          <set_value name="md.$TutorialRegister" exact="[]" />
        </do_if>
        <append_to_list name="md.$TutorialRegister" exact="Start" />
      </actions>
      <cues>
        <cue name="PlayerDied">
          <conditions>
            <event_object_destroyed object="player.entity" />
          </conditions>
          <actions>
            <cancel_cue cue="Start" />
          </actions>
        </cue>

        <cue name="Trigger" checkinterval="5s" version="2">
          <conditions>
            <check_value value="not md.$SurpressTutorials?" />
            <check_value value="player.computer" />
          </conditions>
          <actions>
            <set_value name="$DebugChance" exact="100"/>
            <set_value name="$MissionName" exact="'11) ' + readtext.{30189}.{1}" />
            <set_value name="$Guide" exact="player.computer" />
            <create_offer cue="Start" actor="$Guide" name="$MissionName" description="readtext.{30189}.{2}" difficulty="level.trivial" faction="faction.player" type="missiontype.tutorial">
              <briefing>
                <objective step="1" action="objective.custom" customaction="{30189,20}" comment="Preparing to build"/>
                <objective step="2" action="objective.custom" customaction="{30189,21}" comment="Obtaining a plot"/>
                <objective step="3" action="objective.custom" customaction="{30189,22}" comment="Designing a Station"/>
                <objective step="4" action="objective.custom" customaction="{30189,27}" comment="Construction Vessels"/>
                <!--objective step="9" action="objective.custom" customaction="{30189,28}" comment="Obtaining Additional Blueprints"/-->
              </briefing>
            </create_offer>
          </actions>
          <patch sinceversion="2">
            <do_if value="Start.hasmissionoffer">
              <set_value name="$MissionName" exact="'11) ' + readtext.{30189}.{1}" />
              <update_offer cue="Start" name="$MissionName"/>
            </do_if>
          </patch>
          <cues>
            <cue name="Offer">
              <cues>
                <cue name="ConversationStarted" instantiate="true">
                  <conditions>
                    <event_conversation_started actor="$Guide" conversation="mission" convparam="Start" />
                  </conditions>
                  <actions>
                    <remove_help all="true" />
                    <open_conversation_menu menu="MissionBriefingMenu" param="[0, 0, Start, true]" />
                  </actions>
                  <cues>
                    <cue name="ConversationNextSection" instantiate="true">
                      <conditions>
                        <event_conversation_next_section actor="$Guide" choiceparam="Start" />
                      </conditions>
                      <actions>
                        <!-- Accept case -->
                        <do_if value="event.param == 'c_mission_accept'">
                          <signal_cue cue="Tutorial" />
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="ConversationFinished">
                      <conditions>
                        <event_conversation_finished actor="$Guide" />
                      </conditions>
                      <actions>
                        <cancel_cue cue="ConversationStarted" />
                      </actions>
                    </cue>

                    <cue name="AcceptMission">
                      <conditions>
                        <event_object_signalled object="$Guide" param="'accept'" />
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial" />
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial" version="2">
              <conditions>
                <check_any>
                  <event_cue_signalled />
                  <event_object_signalled object="player.entity" param="'start'" param2="Start" />
                </check_any>
              </conditions>
              <actions>
                <debug_text text="'Tutorial can begin'" chance="$DebugChance" />
                <cancel_cue cue="Offer" />
                <signal_cue_instantly cue="md.Tutorials.NewTutorialTriggered" param="Start" />
                <set_value name="$TutorialStartTime" exact="player.age" />
                <create_mission cue="Start" offercue="Start" />
                <cancel_conversation actor="$Guide" />
                <remove_offer cue="Start" />
                <remove_help all="true"/>
                <set_value name="$StartDelay" exact="2s"/>

                <do_if value="false">
                  <show_help line="6001" duration="7s" position="1" force="true" comment="For this tutorial you need..."/>
                  <show_notification text="{1015,407}" sound="notification_warning" />
                  <remove_mission cue="Start" type="aborted" />
                  <signal_cue cue="Cleanup" />
                </do_if>
                <do_else>
                  <show_help line="1001" duration="7s" position="1" force="true" width="140" comment="You can abort this tutorial in the Active Missions menu " />
                </do_else>
              </actions>
              <patch sinceversion="2">
                <set_value name="$Station" exact="null"/>
              </patch>
              <cues>

                <cue name="Abort">
                  <conditions>
                    <event_mission_aborted cue="Start" />
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <remove_mission cue="Start" type="aborted" />
                    <signal_cue cue="Cleanup" />
                  </actions>
                </cue>

                <cue name="Abort_OtherTutorialStarted">
                  <conditions>
                    <event_cue_signalled cue="md.Tutorials.NewTutorialTriggered" />
                    <check_value value="event.param != Start" />
                  </conditions>
                  <actions>
                    <remove_help all="true"/>
                    <show_notification text="{1015,400}" sound="notification_warning" comment="Tutorial aborted" />
                    <remove_mission cue="Start" type="aborted"/>
                    <signal_cue cue="Cleanup" />
                  </actions>
                </cue>

                <cue name="Tutorial_Init">
                  <delay exact="$StartDelay"/>
                  <actions>
                    <!--Create a list of tutorial cues to trigger in what order, and what briefing step they point to-->
                    <!-- -->
                    <set_value name="$SignalList" exact="[
                                [Tutorial_Preparing, 1],
                                [Tutorial_Plot, 2],
                                [Tutorial_Design, 3],
                                [Tutorial_CV, 4],
                    ]"/>

                    <set_value name="$Index" exact="0"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>

                  </actions>
                </cue>

                <cue name="Tutorial_TriggerNext" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_value name="$Index" operation="add"/>
                    <do_if value="$Index gt $SignalList.count">
                      <remove_help all="true"/>
                      <debug_text text="'Station-building tutorial has been completed'" chance="$DebugChance" />
                      <show_help line="1002" position="1" force="true" comment="Tutorial Completed!" />
                      <show_help line="1003" position="1" force="true" comment="Press $INPUT_ACTION_HELP$ to try other tutorials."/>
                      <remove_mission cue="Start" type="tutorialcompleted" />
                      <signal_cue cue="Cleanup" />
                    </do_if>
                    <do_else>
                      <signal_cue cue="$SignalList.{$Index}.{1}"/>
                      <set_value name="$CurrentStep" exact="$SignalList.{$Index}.{2}"/>
                      <set_objective_from_briefing cue="Start" step="$CurrentStep"/>
                    </do_else>
                  </actions>
                </cue>

                <cue name="Tutorial_Preparing">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="5s"/>
                  <actions>
                    <show_help_multi log="false" position="1" force="true" allowclose="false" width="280">
                      <!--text line="11001" comment="Reveal enough stations to your known map"/-->
                      <text line="992" comment="These yellow-framed boxes are tips. Click the arrow after you have read them to proceed to the next one."/>
                      <text line="11110" comment="First reveal the neighbourhood to know all your competitors"/>
                      <text line="11002" comment="Place satellites near shipyards, wharfs and any economic hub"/>
                      <text line="11003" comment="With trading make money and improve your reputation"/>
                    </show_help_multi>
                  </actions>
                  <cues>
                    <cue name="Tutorial_Preparing_DoneDelayed">
                      <conditions>
                        <event_ui_triggered screen="'hintclosed'" control="'992'"/>
                      </conditions>
                      <delay exact="0.5s"/>
                      <actions>
                        <signal_cue cue="Tutorial_TriggerNext"/>
                        <cancel_cue cue="Tutorial_Preparing"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Plot">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_value name="$MapOpen" exact="false"/>
                    <set_value name="$MapWasOpen" exact="false"/>
                    <set_value name="$PlotMenuWasOpen" exact="false"/>
                    <set_value name="$PlotCreated" exact="false"/>
                    <set_value name="$PlotPurchased" exact="false"/>
                    <set_value name="$PlotConstruction" exact="false"/>
                    <set_value name="$PlotPlaced" exact="false"/>
                    <remove_help all="true"/>
                    <show_help line="11010" duration="5s" position="1" force="true" comment="The station designed in this tutorial can be deleted at the end  without cost"/>
                    <show_help line="11101" position="1" force="true" comment="Press $INPUT_ACTION_OPEN_MAP$ to open the MAP menu" allowclose="false" timeout="false"/>
                  </actions>
                  <cues>

                    <!--cue name="Tutorial_Plot_MenuContinueRehint" checkinterval="25s" instantiate="true">
                      <conditions>
                        <check_value value="$MapWasOpen and not $MapOpen"/>
                      </conditions>
                      <actions>
                        <show_help line="11011" duration="10s" position="1" force="true" comment="Open map and select 'Manage Plot' to continue tutorial"/>
                      </actions>
                    </cue-->

                    <!--cue name="Tutorial_Plot_MenuClosed" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'MapMenu'" control="'menu_close'"/>
                      </conditions>
                      <actions>
                        <set_value name="$MapOpen" exact="false"/>
                      </actions>
                    </cue-->

                    <cue name="Tutorial_Plot_MenuOpen">
                      <conditions>
                        <event_ui_triggered screen="'MapMenu'" control="''"/>
                      </conditions>
                      <actions>
                        <set_value name="$MapWasOpen" exact="true"/>
                        <set_value name="$MapOpen" exact="true"/>
                        <set_value name="$CurrentMapTab" exact="event.param2"/>
                        <remove_help all="true"/>
                        <!--show_help line="11110" duration="10s" position="1" force="true" comment="First reveal the neighbourhood to know all your competitors"/-->
                        <show_help_overlay id="'map_sidebar_plotmanagement'" highlightonly="true" />
                        <show_help line="11120" duration="10s" position="1" force="true" comment="To start planning a station, click on the '{1001,3226(manage plot)'-icon" allowclose="false" timeout="false"/>
                      </actions>
                      <cues>

                        <cue name="Tutorial_Plot_PlotMenuOpenClick">
                          <conditions>
                            <event_ui_triggered screen="'MapMenu'" control="'plots'"/>
                            <check_value value="$CurrentMapTab != 'plots'"/>
                          </conditions>
                          <actions>
                            <remove_help_overlay id="'map_sidebar_plotmanagement'"/>
                            <signal_cue_instantly cue="Tutorial_Plot_PlotMenuOpen"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Plot_PlotMenuAlreadySelected" onfail="cancel">
                          <conditions>
                            <check_value value="$CurrentMapTab == 'plots'" comment="tab already selected on opening map?"/>
                          </conditions>
                          <actions>
                            <show_help line="9003" position="1" force="true" comment="The TRADE category is already selected"/>
                            <signal_cue cue="Tutorial_Plot_PlotMenuOpen"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Plot_PlotMenuOpen">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <actions>
                            <set_value name="$PlotMenuWasOpen" exact="true"/>
                            <remove_help all="true"/>
                            <show_help_multi log="false" position="1" force="true" allowclose="false" width="210">
                              <text line="11137" comment="You may need to pay a fee for your first plot..."/>
                              <text line="11138" comment="A plot right next to a gate or highway is very expensive..."/>
                            </show_help_multi>
                          </actions>
                          <cues>

                            <cue name="Tutorial_Plot_MultiClosed">
                              <conditions>
                                <event_ui_triggered screen="'hintclosed'" control="'11137'"/>
                              </conditions>
                              <actions>
                                <show_help_overlay id="'create_plot_new'" highlightonly="true" />
                                <show_help line="11140" duration="10s" position="1" width="210" force="true" comment="Set an initial size for a plot you can afford and click '{1001,9231}(create new plot)" allowclose="false" timeout="false"/>
                              </actions>
                            </cue>

                            <cue name="Tutorial_Plot_PlotCreated">
                              <conditions>
                                <event_ui_triggered screen="'MapMenu'" control="'createnewplot'"/>
                              </conditions>
                              <actions>
                                <set_value name="$PlotCreated" exact="true"/>
                                <remove_help all="true"/>
                                <remove_help_overlay id="'create_plot_new'"/>
                                <show_help line="11150" duration="10s" position="1" force="true" comment="Place your new plot on the map" allowclose="false" timeout="false"/>
                              </actions>
                              <cues>

                                <cue name="Tutorial_Plot_Placed">
                                  <conditions>
                                    <event_ui_triggered screen="'MapMenu'" control="'plotplaced'"/>
                                  </conditions>
                                  <actions>
                                    <remove_help all="true"/>
                                    <set_value name="$PlotPlaced" exact="true"/>
                                  </actions>
                                  <cues>
                                    <cue name="Tutorial_Plot_PurchaseRehint" onfail="cancel">
                                      <conditions>
                                        <check_value value="player.entity.sector.owner != faction.ownerless"/>
                                      </conditions>
                                      <actions>
                                        <show_help line="11160" position="1" force="true" comment="Look at the price and CONFIRM your purchase" allowclose="false" timeout="false"/>
                                        <show_help_overlay id="'create_plot_purchase'" highlightonly="true" />
                                      </actions>
                                    </cue>

                                    <cue name="Tutorial_Plot_PurchaseOwnerless" onfail="cancel">
                                      <conditions>
                                        <check_value value="player.entity.sector.owner == faction.ownerless"/>
                                      </conditions>
                                      <actions>
                                        <remove_help all="true"/>
                                        <show_help line="11161" duration="7s" position="1" force="true" comment="This sector is ownerless, so you don't need to purchase a license."/>
                                      </actions>
                                      <delay exact="8s"/>
                                      <actions>
                                        <signal_cue cue="Tutorial_Plot_PurchasedLicense"/>
                                      </actions>
                                    </cue>

                                    <cue name="Tutorial_Plot_PurchasedLicense">
                                      <conditions>
                                        <check_any>
                                          <event_cue_signalled comment="no license needed (ownerless sector)"/>
                                          <event_ui_triggered screen="'MapMenu'" control="'buyplot'"/>
                                        </check_any>
                                      </conditions>
                                      <actions>
                                        <set_value name="$PlotPurchased" exact="true"/>
                                        <remove_help all="true"/>
                                        <remove_help_overlay id="'create_plot_purchase'"/>
                                      </actions>
                                      <delay exact="0.5s"/>
                                      <actions>
                                        <show_help line="11170" duration="10s" position="1" force="true" comment="Click 'continue' to design your station" allowclose="false" timeout="false"/>
                                        <show_help_overlay id="'create_plot_continue'" highlightonly="true" />
                                      </actions>
                                      <cues>

                                        <cue name="Tutorial_Plot_Construction" instantiate="true">
                                          <conditions>
                                            <event_ui_triggered screen="'MapMenu'" control="'initiateconstruction_station'" comment="event.param3 is station-id (as string)"/>
                                            <!--event_ui_triggered screen="'MapMenu'" control="'initiateconstruction'"/-->
                                            <!-- alternatively could check for 'MapMenu' and 'StationConfigurationMenu' (which is automatically opened after clicking "continue")-->
                                          </conditions>
                                          <actions>
                                            <remove_help_overlay id="'create_plot_continue'"/>
                                            <remove_help all="true"/>
                                            <set_value name="$Station" exact="component.{event.param3}"/>
                                            <set_value name="$PlotConstruction" exact="true"/>
                                          </actions>
                                          <cues>
                                            <cue name="Tutorial_Plot_DoneDelayed">
                                              <delay exact="1s"/>
                                              <actions>
                                                <signal_cue cue="Tutorial_TriggerNext"/>
                                                <cancel_cue cue="Tutorial_Plot"/>
                                              </actions>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Design">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <remove_help all="true" />
                    <set_value name="$DockTabWasOpen" exact="false"/>
                    <set_value name="$PlacedDock" exact="false"/>
                    <set_value name="$PlacedConnectionModule" exact="false"/>
                    <set_value name="$PlacedSolarModule" exact="false"/>
                    <set_value name="$PlacedStorageModule" exact="false"/>
                    <set_value name="$CreditsBuilder" exact="false"/>
                  </actions>
                  <delay exact="0.5s"/>
                  <actions>
                    <show_help_multi log="false" position="1" force="true" allowclose="false" width="240">
                      <text line="11201" comment="Here you can plan the design of your station"/>
                      <text line="11202" comment="On the left you see categories of station modules"/>
                      <text line="11203" comment="You need BLUEPRINTS in order to see more available modules"/>
                      <text line="11204" comment="Every station needs a DOCK for smaller ships and optionally a PIER for capital ships"/>
                      <text line="11205" comment="Create distance with connection modules"/>
                    </show_help_multi>
                  </actions>
                  <cues>

                    <cue name="Tutorial_Design_Dock_Overlay">
                      <conditions>
                        <event_ui_triggered screen="'hintclosed'" control="'11201'"/>
                      </conditions>
                      <actions>
                        <remove_help all="true"/>
                        <show_help_overlay id="'stationbuildst_dock'" highlightonly="true" />
                        <do_all exact="8" counter="$i">
                          <show_help_overlay id="'stationbuildst_dock_dockarea' + $i" highlightonly="true" />
                          <show_help line="11210" duration="10s" position="1" force="true" comment="Select the DOCK tab" allowclose="false" timeout="false"/>
                        </do_all>
                      </actions>
                    </cue>

                    <cue name="Tutorial_Design_PlacedDebug" instantiate="true">
                      <conditions>
                        <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                      </conditions>
                      <actions>
                        <debug_text text="'Placed: ' + event.param3 + ' class: ' + event.param3.class"/>
                      </actions>
                    </cue>

                    <cue name="Tutorial_Design_DockTabSelected">
                      <conditions>
                        <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_dock'"/>
                        <check_value value="event.param3 == 'on'"/>
                      </conditions>
                      <actions>
                        <set_value name="$DockTabWasOpen" exact="true"/>
                        <remove_help all="true" />
                        <remove_help_overlay id="'stationbuildst_dock'"/>
                        <show_help line="11220" position="1" force="true" comment="Drag a DOCK into your plot area" allowclose="false" timeout="false"/>
                      </actions>
                      <cues>

                        <cue name="Tutorial_Design_PlacedNotDock" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                            <check_value value="(not $PlacedDock) and (not event.param3.isclass.dockarea)"/>
                          </conditions>
                          <actions>
                            <show_help line="11220" duration="10s" position="1" force="true" comment="Drag a DOCK into your plot area"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Design_PlacedDock">
                          <conditions>
                            <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                            <check_value value="event.param3.isclass.dockarea"/>
                          </conditions>
                          <actions>
                            <set_value name="$PlacedDock" exact="true"/>
                            <remove_help all="true" />
                            <do_all exact="8" counter="$i">
                              <remove_help_overlay id="'stationbuildst_dock_dockarea' + $i"/>
                            </do_all>
                          </actions>
                          <delay exact="0.5s"/>
                          <actions>
                            <show_help_multi log="false" position="1" force="true" allowclose="false" width="280">
                              <text line="11308" comment="Connect modules by moving connections over another..."/>
                              <text line="11306" comment="During design phase you can move around already connected modules"/>
                            </show_help_multi>
                          </actions>
                          <cues>

                            <cue name="Tutorial_Design_Other_Overlay">
                              <conditions>
                                <event_ui_triggered screen="'hintclosed'" control="'11308'"/>
                              </conditions>
                              <actions>
                                <remove_help all="true"/>
                                <show_help_overlay id="'stationbuildst_other'" highlightonly="true" />
                                <do_all exact="8" counter="$i">
                                  <show_help_overlay id="'stationbuildst_other_struct' + $i" highlightonly="true" />
                                </do_all>
                                <show_help line="11301" duration="10s" position="1" force="true" comment="Drag a connection module and connect it with the dock" allowclose="false" timeout="false"/>
                              </actions>
                            </cue>

                            <cue name="Tutorial_Design_Other_Selected">
                              <conditions>
                                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_other'"/>
                                <check_value value="event.param3 == 'on'"/>
                              </conditions>
                              <actions>
                                <remove_help_overlay id="'stationbuildst_other'"/>
                              </actions>
                            </cue>

                            <cue name="Tutorial_Design_PlacedConnection">
                              <conditions>
                                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                                <check_value value="event.param3.isclass.connectionmodule"/>
                                <check_value value="not $PlacedConnectionModule"/>
                              </conditions>
                              <actions>
                                <do_all exact="8" counter="$i">
                                  <remove_help_overlay id="'stationbuildst_other_struct' + $i"/>
                                </do_all>
                                <set_value name="$PlacedConnectionModule" exact="true"/>
                                <remove_help all="true" />
                              </actions>
                              <cues>

                                <cue name="Tutorial_Design_Production_Overlay">
                                  <delay exact="0.5s"/>
                                  <actions>
                                    <show_help_overlay id="'stationbuildst_production'" highlightonly="true" />
                                    <show_help_overlay id="'stationbuildst_production_energycells'" highlightonly="true" />
                                    <show_help line="11407" duration="10s" position="1" force="true" comment="Add a production component from the production components category." allowclose="false" timeout="false"/>
                                  </actions>
                                </cue>

                                <cue name="Tutorial_Design_Production_Selected">
                                  <conditions>
                                    <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_production'"/>
                                    <check_value value="event.param3 == 'on'"/>
                                  </conditions>
                                  <actions>
                                    <remove_help all="true"/>
                                    <remove_help_overlay id="'stationbuildst_production'"/>
                                  </actions>
                                </cue>

                                <cue name="Tutorial_Design_PlacedSolar">
                                  <conditions>
                                    <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                                    <check_value value="event.param3.isclass.production"/>
                                  </conditions>
                                  <actions>
                                    <set_value name="$PlacedSolarModule" exact="true"/>
                                    <remove_help all="true" />
                                    <remove_help_overlay id="'stationbuildst_production_energycells'"/>
                                    <show_help_multi log="false" position="1" force="true" allowclose="false" width="280">
                                      <text line="11408" comment="Hold down RMB on a solar production and drag to ROTATE it."/>
                                      <text line="11403" comment="For a production to work you also need STORAGE."/>
                                      <text line="11409" comment="Most production components need CONTAINER storage."/>
                                      <text line="11405" comment="Refineries need SOLID storage for ORE or LIQUID storage for gas."/>
                                      <text line="11406" comment="Adding a living section with WORKFORCE can later improve your productivity."/>
                                    </show_help_multi>
                                  </actions>
                                  <cues>

                                    <cue name="Tutorial_Design_Storage_Overlay">
                                      <conditions>
                                        <event_ui_triggered screen="'hintclosed'" control="'11408'"/>
                                      </conditions>
                                      <actions>
                                        <remove_help all="true"/>
                                        <show_help_overlay id="'stationbuildst_storage'" highlightonly="true" />
                                        <do_all exact="8" counter="$i">
                                          <show_help_overlay id="'stationbuildst_storage_solid' + $i" highlightonly="true" />
                                        </do_all>
                                        <show_help line="11451" duration="10s" position="1" force="true" comment="Add a SOLID STORAGE to your station." allowclose="false" timeout="false"/>
                                      </actions>
                                    </cue>

                                    <cue name="Tutorial_Design_Storage_Selected">
                                      <conditions>
                                        <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_storage'"/>
                                        <check_value value="event.param3 == 'on'"/>
                                      </conditions>
                                      <actions>
                                        <remove_help all="true"/>
                                        <remove_help_overlay id="'stationbuildst_storage'"/>
                                      </actions>
                                    </cue>

                                    <cue name="Tutorial_Design_PlacedStorage">
                                      <conditions>
                                        <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                                        <check_value value="event.param3.isclass.storage"/>
                                      </conditions>
                                      <actions>
                                        <set_value name="$PlacedStorageModule" exact="true"/>
                                        <remove_help all="true" />
                                        <do_all exact="8" counter="$i">
                                          <remove_help_overlay id="'stationbuildst_storage_solid' + $i"/>
                                        </do_all>
                                        <show_help_multi log="false" position="1" force="true" allowclose="false" width="280">
                                          <text line="11470" comment="The right tab shows how many resources are needed..."/>
                                          <text line="11471" comment="You can move resources there manually with your own trade ships..."/>
                                          <text line="11456" comment="To buy from other traders your Builder needs a BUDGET."/>
                                        </show_help_multi>
                                      </actions>
                                      <cues>

                                        <cue name="Tutorial_Design_BuyOffers_Overlay">
                                          <conditions>
                                            <event_ui_triggered screen="'hintclosed'" control="'11470'"/>
                                          </conditions>
                                          <actions>
                                            <show_help_overlay id="'plot_resources_buyoffers'" highlightonly="true" />
                                            <show_help_overlay id="'confirm_credits'" highlightonly="true" />
                                            <show_help line="11457" duration="5s" position="1" force="true" comment="Expand the '{1001,7928}'-menu" allowclose="false" timeout="false"/>
                                          </actions>
                                        </cue>

                                        <cue name="Tutorial_Design_BuyOffers_Selected">
                                          <conditions>
                                            <event_ui_triggered screen="'StationConfigurationMenu'" control="'extendresourceentry'"/>
                                          </conditions>
                                          <actions>
                                            <remove_help all="true"/>
                                            <remove_help_overlay id="'plot_resources_buyoffers'"/>
                                            <show_help line="11458" position="1" force="true" comment="Assign credits to the Builder." allowclose="false" timeout="false"/>
                                          </actions>
                                        </cue>

                                        <cue name="Tutorial_Design_CreditsAssigned">
                                          <conditions>
                                            <event_ui_triggered screen="'StationConfigurationMenu'" control="'confirmcredits'"/>
                                          </conditions>
                                          <actions>
                                            <set_value name="$CreditsBuilder" exact="true"/>
                                            <remove_help all="true" />
                                            <remove_help_overlay id="'confirm_credits'"/>
                                          </actions>
                                          <delay exact="0.5s"/>
                                          <actions>
                                            <show_help line="11501" duration="7s" position="1" force="true" comment="To bring wares manually use WARE EXCHANGE."/>
                                          </actions>
                                          <cues>
                                            <cue name="Tutorial_Design_DoneDelayed">
                                              <conditions>
                                                <event_ui_triggered screen="'hintclosed'" control="'11501'"/>
                                              </conditions>
                                              <delay exact="0.5s"/>
                                              <actions>
                                                <signal_cue cue="Tutorial_TriggerNext"/>
                                                <cancel_cue cue="Tutorial_Design"/>
                                              </actions>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>

                      </cues>

                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_CV">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_value name="$SelectCV" exact="false"/>
                    <set_value name="$AssignedCV" exact="false"/>

                    <do_if value="@$Station.buildstorage.buildmodule.constructionvessel.exists">
                      <debug_text text="'CV Already assigned'"/>
                      <set_value name="$SelectCV" exact="true"/>
                      <set_value name="$AssignedCV" exact="true"/>
                    </do_if>
                    <do_else>
                      <show_help_overlay id="'assign_hire_builder'" highlightonly="true" />
                    </do_else>

                    <set_value name="$CancelStation" exact="false"/>
                    <show_help line="11502" position="1" force="true" comment="A BUILDER ship is needed for construction to start."/>
                    <show_help line="11503" position="1" force="true" comment="Click on ASSIGN BUILDER SHIP" allowclose="false" timeout="false"/>
                  </actions>
                  <cues>

                    <!-- One-time check if CV already assigned, if so skip this part of the tutorial -->
                    <cue name="Tutorial_CV_AlreadyAssigned" onfail="cancel">
                      <conditions>
                        <check_value value="$SelectCV"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial_CV_Cancel"/>
                      </actions>
                    </cue>

                    <cue name="Tutorial_CV_SelectCV">
                      <conditions>
                        <event_ui_triggered screen="'StationConfigurationMenu'" control="'assignhirebuilder'"/>
                      </conditions>
                      <delay exact="1s"/>
                      <actions>
                        <set_value name="$SelectCV" exact="true"/>
                        <remove_help all="true" />
                        <remove_help_overlay id="'assign_hire_builder'"/>
                        <show_help_multi log="false" position="1" force="true" allowclose="false" width="240">
                          <text line="11601" comment="Hire any BUILDER ship that is anywhere in your live view"/>
                          <text line="11602" comment="Zoom out to see if any ships are in range."/>
                          <text line="11603" comment="To see more ships place satellites near gates, shipyards or economic hubs"/>
                        </show_help_multi>
                        <show_help line="11610" position="1" force="true" comment="Open context menu on BUILDER ship and select it." allowclose="false" timeout="false"/>
                      </actions>
                      <cues>

                        <cue name="Tutorial_CV_AssignCV">
                          <conditions>
                            <event_ui_triggered screen="'MapMenu'" control="'selectactive'"/>
                          </conditions>
                          <actions>
                            <set_value name="$AssignedCV" exact="true"/>
                            <remove_help all="true" />
                            <show_help_multi log="false" position="1" force="true" allowclose="false" width="240">
                              <text line="11701" comment="Get more BLUEPRINTS for many lucrative station expansions."/>
                              <text line="11702" comment="Buy BLUEPRINTS from faction administrators."/>
                              <text line="11703" comment="Or by SCANNING stations or the RESEARCH MISSION (name of plot mission?)."/>
                              <!--text line="11704" comment="Go back to build mode with the DESIGN STATION action."/-->
                              <text line="11801" comment="You can remove modules and delete the plot to undo the station."/>
                            </show_help_multi>
                            <signal_cue cue="Tutorial_CV_Cancel"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="Tutorial_CV_Cancel">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <!--show_help_overlay id="'confirm_modulechanges'" highlightonly="true"/-->
                        <show_help_overlay id="'cancel_modulechanges'" highlightonly="true"/>
                        <show_help line="11612" position="1" force="true" comment="Cancel your changes" allowclose="false" timeout="false"/>
                      </actions>
                      <cues>

                        <cue name="Tutorial_CV_CancelOrConfirm2">
                          <conditions>
                            <check_any>
                              <event_ui_triggered screen="'StationConfigurationMenu'" control="'cancelmodulechanges'"/>
                              <event_ui_triggered screen="'StationConfigurationMenu'" control="'confirmmodulechanges'"/>
                            </check_any>
                          </conditions>
                          <actions>
                            <remove_help all="true"/>
                            <set_value name="$CancelStation" exact="true"/>
                            <show_help_overlay id="'cancel_modulechanges'" highlightonly="true" />
                          </actions>
                          <cues>
                            <cue name="Tutorial_CV_CancelX">
                              <conditions>
                                <event_ui_triggered screen="'StationConfigurationMenu'" control="'menu_close'"/>
                              </conditions>
                              <delay exact="0.5s"/>
                              <actions>
                                <show_help_overlay id="'menu_cancel_plot'" highlightonly="true"/>
                                <show_help line="11705" position="1" duration="7s" force="true" comment="Cancel your plot by clicking the 'x'."/>
                              </actions>
                              <cues>
                                <cue name="Tutorial_CV_DoneDelayed2_v2">
                                  <conditions>
                                    <event_ui_triggered screen="'hintclosed'" control="'11705'"/>
                                  </conditions>
                                  <actions>
                                    <remove_help_overlay id="'menu_cancel_plot'"/>
                                    <signal_cue cue="Tutorial_TriggerNext"/>
                                    <cancel_cue cue="Tutorial_CV"/>
                                  </actions>
                                </cue>

                              </cues>
                            </cue>
                          </cues>

                        </cue>
                      </cues>
                    </cue>

                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Cleanup">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay all="true"/>
                <debug_text text="'cleanup'" chance="$DebugChance"/>
                <do_if value="$BriefingCutsceneStarted?">
                  <stop_cutscene key="$CutsceneKey"/>
                </do_if>
                <do_if value="$Beacons?">
                  <destroy_group group="$Beacons"/>
                </do_if>
                <remove_offer cue="Start"/>
                <remove_mission cue="Start" />
                <reset_cue cue="Trigger"/>
              </actions>
            </cue>

          </cues>
        </cue>

      </cues>
    </cue>
  </cues>
</mdscript>
